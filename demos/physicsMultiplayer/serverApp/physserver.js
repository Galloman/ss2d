(function(){var m=!0,s=null,t=!1;function v(){return function(){}}function B(a){return function(){return this[a]}}function C(a){return function(){return a}}var E;function F(a,b){function c(){}c.prototype=b.prototype;a.tg=b.prototype;a.prototype=new c};var aa;function ba(a,b){if(!a)throw"Pickable component need an owner";this.ua=a||s;this.Pc=t;this.Xd=new ca;this.Cf=m;this.ub=b||s;this.Fe=this.Hf=t;this.ta=this.eb=s}
ba.prototype.Ya=function(a,b){var c=b||aa.ta;this.Fe=t;if(c.Lc&&!c.Ie&&this.ua.Jc(c.pc)){this.ta&&(da(fa().Ub,this.eb),this.eb=s,this.ta=this.ta.kc=s);c.kc&&(this.ub&&this.eb&&(da(fa().Ub,this.eb),this.ta=this.eb=s),c.kc.Pc=t);this.Pc=this.Fe=m;this.ta=c;c.kc=this;var d=ga(ha(this.ua).nc(),c.pc);this.Xd.set(this.ua.ba.t-d.t,this.ua.ba.u-d.u);if(this.ub){var d=fa(),e=this.ub,f=this.ta||aa.ta;md=new ia;md.za=d.Ub.Oe;md.Aa=e.Eb;f=ga(ha(e.ua).nc(),f.pc);md.target.n(f.t,f.u);md.$e=1E3*e.Eb.Da;md.la=m;
md.Gd=1/30;d=d.Ub;f=md;e=ja(f);e.F=s;if(e.s=d.Z)d.Z.F=e;d.Z=e;++d.pb;e.p.Sb=e;e.p.na=e.g;e.p.r=s;if(e.p.next=e.i.Z)e.i.Z.r=e.p;e.i.Z=e.p;e.q.Sb=e;e.q.na=e.i;e.q.r=s;if(e.q.next=e.g.Z)e.g.Z.r=e.q;e.g.Z=e.q;if(f.la==t)for(f=(f.za.fc<f.Aa.fc?f.za:f.Aa).gc;f;f=f.s)f.Jd(d.gb);this.eb=e;ma(this.ub.Eb)}}(this.Pc=c.kc==this&&this.ta&&this.ta.Lc)?(c=this.ta,this.Cf&&(d=ga(ha(this.ua).nc(),c.pc),this.ub?this.eb&&this.eb.Ac.n(d.t,d.u):(this.ua.ba.t=d.t+this.Xd.t,this.ua.ba.u=d.u+this.Xd.u))):c.kc==this&&(c.kc=
s,this.ub&&this.eb&&(da(fa().Ub,this.eb),this.ta=this.eb=s));this.Hf=this.Pc};function na(a,b,c,d){this.t=a;this.u=b;this.ob=c;this.mb=d}na.prototype.dd=function(a,b,c,d){this.t=a;this.u=b;this.ob=c;this.mb=d;return this};na.prototype.toString=function(){return"("+this.t+","+this.u+","+this.ob+","+this.mb+")"};na.prototype.contains=function(a,b){return a>=this.t&&b>=this.u&&a<=this.t+this.ob&&b<=this.u+this.mb};function oa(a){if(a instanceof oa)this.pd=a.pd.slice(0);else if(a instanceof Array&&2<a.length)this.pd=a.slice(0);else if("string"==typeof a||"number"==typeof a)"string"==typeof a&&(a=parseInt("0x"+a.replace("#","").substring(0,6))),a&=16777215,this.pd=[(a&16711680)>>16,(a&65280)>>8,a&255]};function ca(a,b){this.t=a;this.u=b}ca.prototype.set=function(a,b){this.t=a;this.u=b};ca.prototype.length=function(){return Math.sqrt(this.t*this.t+this.u*this.u)};function pa(){this.Sa=1;this.Ua=this.Ta=0;this.Va=1;this.$a=this.Za=0;this.ig=Array(9)}E=pa.prototype;E.dd=function(a,b,c,d,e,f){this.Sa=a;this.Ta=b;this.Ua=c;this.Va=d;this.Za=e;this.$a=f;return this};E.toString=function(){return"(a="+this.Sa+", b="+this.Ta+", c="+this.Ua+", d="+this.Va+", tx="+this.Za+", ty="+this.$a+")"};function qa(a,b){a.dd(b.Sa*a.Sa+b.Ua*a.Ta,b.Ta*a.Sa+b.Va*a.Ta,b.Sa*a.Ua+b.Ua*a.Va,b.Ta*a.Ua+b.Va*a.Va,b.Sa*a.Za+b.Ua*a.$a+1*b.Za,b.Ta*a.Za+b.Va*a.$a+1*b.$a)}
E.translate=function(a,b){this.Za+=a;this.$a+=b;return this};E.scale=function(a,b){this.Sa*=a;this.Ta*=b;this.Ua*=a;this.Va*=b;this.Za*=a;this.$a*=b;return this};E.rotate=function(a){var b=new pa;b.dd(Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0);qa(this,b);delete b;return this};function ga(a,b){var c;c||(c=new ca(0,0));var d=b.t;c.t=a.Sa*b.t+a.Ua*b.u+a.Za;c.u=a.Ta*d+a.Va*b.u+a.$a;return c}
E.nc=function(){var a=this.Sa*this.Va-this.Ua*this.Ta;this.dd(this.Va/a,-this.Ta/a,-this.Ua/a,this.Sa/a,(this.Ua*this.$a-this.Va*this.Za)/a,(this.Ta*this.Za-this.Sa*this.$a)/a);return this};var ra=0;function sa(a,b,c,d,e,f){this.ba=new ca(a||0,b||0);this.Sc=d||0;this.Rc=this.Qc=0;this.qc=c||1;this.rc=c||1;this.Tb=s;this.Be=e instanceof oa?e:new oa(e||16777215);this.yf=f||1;this.Oc=ra++;this.Ke=[]}E=sa.prototype;E.lb=1001;
function ha(a){for(var b=[];a.Tb;)b.push(a.Tb),a=a.Tb;a=new pa;var c=new pa;for(matIndex in b){c.dd(1,0,0,1,0,0);var d=b[matIndex],e=c,e=e||new pa;(0!=d.Qc||0!=d.Rc)&&e.translate(-d.Qc,-d.Rc);(1!=d.qc||1!=d.rc)&&e.scale(d.qc,d.rc);0!=d.Sc&&e.rotate(d.Sc);(0!=d.ba.t||0!=d.ba.u)&&e.translate(d.ba.t,d.ba.u);qa(a,c)}return a}E.Ya=v();E.lc=C(s);E.Jc=C(s);E.Qd=C(0);E.Pd=C(0);E.toJSON=function(){return"{"+this.Ma()+"}"};
E.Ma=function(){var a;a=""+('"cid":'+this.lb+",");a+='"doid":'+this.Oc+",";a+='"x":'+Math.floor(1E3*this.ba.t)/1E3+",";a+='"y":'+Math.floor(1E3*this.ba.u)/1E3+",";a+='"r":'+Math.floor(100*this.Sc)/100+",";a+='"px":'+this.Qc+",";a+='"py":'+this.Rc+",";a+='"sx":'+this.qc+",";a+='"sy":'+this.rc+",";a+='"c":'+JSON.stringify(this.Be.pd)+",";a+='"a":'+this.yf;return a+=',"snds":'+JSON.stringify(this.Ke)};function I(a,b,c,d,e){sa.call(this,a,b,1,0,e,1);this.ob=c||10;this.mb=d||10}F(I,sa);E=I.prototype;E.lb=1003;E.Qd=B("ob");E.Pd=B("mb");E.lc=function(){return new na(this.ba.t-this.Qc*this.qc,this.ba.u-this.Rc*this.rc,this.Qd()*this.qc,this.Pd()*this.rc)};E.Jc=function(a){a=ga(ha(this).nc(),a);return this.lc().contains(a.t,a.u)?this:s};E.toJSON=function(){return"{"+this.Ma()+"}"};E.Ma=function(){var a=sa.prototype.Ma.call(this)+",",a=a+('"w": '+this.Qd()+",");return a+='"h": '+this.Pd()};function ta(a,b,c,d,e,f){I.call(this,a,b,c,d);this.lg=f||s;this.Le=e||s;this.Vd=[]}F(ta,I);ta.prototype.lb=1004;ta.prototype.toJSON=function(){return"{"+this.Ma()+"}"};ta.prototype.Ma=function(a){var b=I.prototype.Ma.call(this);a&&(b+=',"t": "'+this.Le.Df+'"');this.Vd&&3<this.Vd.length&&(b+=',"clip": '+JSON.stringify(this.Vd));this.jg=this.Le.Df;return b};function ua(a,b,c){if(!a)throw"Rigid body component requires an owner";this.ua=a;this.zf=b||va;"undefined"==typeof c&&(c=m);this.Af=c;this.reset()}var va=1;
ua.prototype.reset=function(){var a=fa();switch(this.zf){case va:var b=this.ua.lc();this.ua.Qc=0.5*b.ob;this.ua.Rc=0.5*b.mb;var c=this.ua.ba,d=c.t,c=c.u,e=0.5*b.ob,f=0.5*b.mb,g=!this.Af,h;"undefined"==typeof g&&(g=m);"undefined"==typeof h&&(h=t);b=new wa;g||(b.Nd=1);h&&(b.S="filled");b.$.n(e,f);h=new xa;for(e=0;64>e;++e)if(h.Bc[e]==s){h.Bc[e]=b;break}h.position.n(d,c);this.Eb=ya(a.Ub,h);this.Eb.l=this.ua.Sc+Math.PI;break;case 2:break;case 3:break;default:throw"["+bodyType+"] is not a valid body type";
}};ua.prototype.Ya=function(){this.Eb&&(this.ua.ba.t=this.Eb.c.x,this.ua.ba.u=this.Eb.c.y,this.ua.Sc=this.Eb.l-Math.PI)};function za(a,b){ta.call(this,a,b,40,40,"textures/crate0.png");this.ub=new ua(this);this.Ff=new ba(this,this.ub)}F(za,ta);za.prototype.lb=3001;za.prototype.Ya=function(a){for(var b=aa.Ce.Gb,c=0;c<b.length;++c)this.Ff.Ya(a,b[c].ta);this.ub.Ya(a)};function Aa(a,b,c,d){sa.call(this,a,b,c,d);this.aa=[];this.rd=[]}F(Aa,sa);E=Aa.prototype;E.lb=1002;E.Ya=function(a){Ba(this,a)};function Ba(a,b){for(var c in a.aa)a.aa[c].Ya&&a.aa[c].Ya(b)}function Ca(a,b){if(b instanceof Array)for(var c in b)Ca(a,b[c]);else b instanceof sa&&(b.Tb&&Da(b.Tb,b),b.Tb=a,a.aa.push(b))}function Da(a,b){if(b instanceof Array)for(var c in b)Da(a,b[c]);else c=a.aa.indexOf(b),-1!=c&&(a.rd.push(b.Oc),a.aa.splice(c,1)),b.Tb=s}
E.Jc=function(a){for(var b=s,c=this.aa.length-1;0<=c&&!b;--c)b=this.aa[c].Jc(a);return b};E.lc=function(){if(0==this.aa.length){var a=ga(ha(this),this.ba);return new na(a.t,a.u)}for(var a=this.aa[0].lc(),b=a.t,c=a.u,d=a.t+a.ob,e=a.u+a.mb,f=1;f<this.aa.length;++f)a=this.aa[f].lc(),b=b<a.t?b:a.t,c=c<a.u?c:a.u,d=d>a.t+a.ob?d:a.t+a.ob,e=e>a.u+a.mb?e:a.u+a.mb;return new na(b,c,(d-b)*this.qc,(e-c)*this.rc)};E.toJSON=function(){return"{"+this.Ma()+"}"};
E.Ma=function(a,b){var c="";b?(c+='"cid":'+this.lb+",",c+='"doid":'+this.Oc+","):c+=sa.prototype.Ma.call(this)+",";for(var c=c+'"clist":[',d=0;d<this.aa.length;d++)c+=this.aa[d].toJSON(),d+1<this.aa.length&&(c+=",");c=c+"]"+(',"rmobjts":'+JSON.stringify(this.rd));a||(delete this.rd,this.rd=[]);return c};function Ea(){Aa.call(this);this.He=s}F(Ea,Aa);E=Ea.prototype;E.lb=1006;E.Ya=function(a){Ba(this,a);a=this.He.Ce;if(0<a.Gb.length){var b='["SCENE",'+this.toJSON()+"]",c;for(c in a.Gb)a.Gb[c].send(b)}};E.bf=v();E.cf=v();E.af=v();E.Ma=function(){return Aa.prototype.Ma.call(this,m,m)};var L={Yf:60,hf:800,gf:600,jf:"localhost",xe:0};L.Xf=60;L.we=35;L.jf="niutek.net";L.xe=51E3;function M(a){I.call(this,0,0,5,5,16777215);this.qd=a||s;this.sc=""}F(M,I);M.prototype.lb=3003;M.createFromSerializedObject=function(a){var b=new M;b.Oc=a.doid;return b};M.prototype.Jc=function(a){var b=new ca(this.ba.t,this.ba.u);a=ga(ha(this).nc(),a);a=Math.abs(Math.sqrt((a.t-b.t)*(a.t-b.t)+(a.u-b.u)*(a.u-b.u)));delete b;return a<=this.kg?this:s};M.prototype.Ya=function(){this.ba.t=this.qd.ta.Mc;this.ba.u=this.qd.ta.Nc};M.prototype.toJSON=function(){return"{"+this.Ma()+"}"};
M.prototype.Ma=function(){var a='"cid":'+this.lb+",",a=a+('"doid":'+this.Oc+","),a=a+('"x":'+Math.floor(this.ba.t)+","),a=a+('"y":'+Math.floor(this.ba.u)+",");return a+='"uname":"'+this.sc+'"'};function Fa(){Ea.call(this);for(var a=30;a--;){var b=new za(0.5*L.hf+10*Math.random(),0.5*L.gf+10*Math.random());Ca(this,b)}a=new I(500,650,1E3,30,"#ff0000");Ca(this,a);a.$d=new ua(a,s,t);a=new I(500,-500,1E3,30,"#ff0000");Ca(this,a);a.$d=new ua(a,s,t);a=new I(0,0,30,1400,"#ff0000");Ca(this,a);a.$d=new ua(a,s,t);a=new I(1E3,0,30,1400,"#ff0000");Ca(this,a);a.$d=new ua(a,s,t);this.nb=new Aa;Ca(this,this.nb)}F(Fa,Ea);Fa.prototype.lb=3002;Fa.prototype.bf=function(a){Ca(this.nb,new M(a));aa.Wd=L.we};
Fa.prototype.cf=function(a){for(var b=0;b<this.nb.aa.length;++b){var c=this.nb.aa[b];c.qd==a&&(Da(this.nb,c),b=this.nb.aa.length,console.log(a.sc+" disconnect"))}0==this.nb.aa.length&&(aa.Wd=0.5)};Fa.prototype.af=function(a){for(var b=0;b<this.nb.aa.length;++b){var c=this.nb.aa[b];c.qd==a&&(c.sc=a.sc,b=this.nb.aa.length)}};var Ga=Math.PI,Ha=2/180*Ga,Ia=8/180*Ga,Ka=2/180/1;function La(a,b){this.x=void 0!==a?a:0;this.y=void 0!==b?b:0}La.prototype.toString=function(){return"("+this.x+", "+this.y+")"};La.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};La.prototype.translate=function(a,b){a instanceof La?(this.x+=a.x,this.y+=a.y):(this.x+=a,"number"==typeof b&&(this.y+=b));return this};La.prototype.scale=function(a,b){this.x*=a;this.y*="number"==typeof b?b:a;return this};function Ma(a,b){this.x=a;this.y=b}F(Ma,La);function O(a){return Math.sqrt(a.x*a.x+a.y*a.y)}Ma.prototype.scale=La.prototype.scale;Ma.prototype.nc=function(){this.x=-this.x;this.y=-this.y;return this};Ma.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};Ma.prototype.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};function Na(a,b){return a.x*b.x+a.y*b.y};function P(a,b){void 0===a&&(a=0);this.x=a;void 0===b&&(b=0);this.y=b}F(P,Ma);E=P.prototype;E.ra=function(){this.y=this.x=0};E.n=function(a,b){this.x=a;this.y=b};function Q(a,b){a.x=b.x;a.y=b.y}E.Id=function(){return new P(this.x,this.y)};function Oa(a,b){var c=a.x;a.x=b.a.x*c+b.b.x*a.y;a.y=b.a.y*c+b.b.y*a.y}E.ic=function(){this.x=Math.abs(this.x);this.y=Math.abs(this.y)};E.Gc=function(){return isFinite(this.x)&&isFinite(this.y)};function Pa(a,b){return new P(a.x+b.x,a.y+b.y)};function Qa(){this.type=Ra;this.S=s;this.Db=new P(0,0);this.xf=0;this.gd=0.2;this.Nd=this.Fd=0;this.Ic=1;this.bd=65535;this.Ae=0}Qa.prototype.te=function(a){a.ga=new P(0,0);a.Mb=0;a.fd=0};Qa.prototype.Ic=0;Qa.prototype.bd=0;Qa.prototype.Ae=0;var Ra=-1;function xa(){this.Bc=[];this.S=s;for(var a=0;64>a;a++)this.Bc[a]=s;this.position=new P(0,0);this.rotation=0;this.wf=new P(0,0);this.of=this.vf=this.Ld=0;this.nf=m;this.Tf=this.tf=t};function T(a,b,c){a==s&&(a=0);this.a=new P;this.b=new P;b!=s&&c!=s?(Q(this.a,b),Q(this.b,c)):(b=Math.cos(a),a=Math.sin(a),this.a.x=b,this.b.x=-a,this.a.y=a,this.b.y=b)}E=T.prototype;E.n=function(a){var b=Math.cos(a);a=Math.sin(a);this.a.x=b;this.b.x=-a;this.a.y=a;this.b.y=b};E.Id=function(){return new T(0,this.a,this.b)};function Sa(a,b){Q(a.a,b.a);Q(a.b,b.b)}function Ta(a,b){a.a.x+=b.a.x;a.a.y+=b.a.y;a.b.x+=b.b.x;a.b.y+=b.b.y}E.ra=function(){this.a.x=0;this.b.x=0;this.a.y=0;this.b.y=0};
function Ua(a,b){var c=a.a.x,d=a.b.x,e=a.a.y,f=a.b.y,g;g=1/(c*f-d*e);b.a.x=g*f;b.b.x=-g*d;b.a.y=-g*e;b.b.y=g*c}E.Kd=function(a,b,c){var d=this.a.x,e=this.b.x,f=this.a.y,g=this.b.y,h;h=1/(d*g-e*f);a.x=h*(g*b-e*c);a.y=h*(d*c-f*b);return a};E.ic=function(){this.a.ic();this.b.ic()};function Va(a,b){this.e=new T;this.c=new P;this.Lb=a.S;this.Ba=a.gd;this.Ea=a.Fd;this.V=b;this.Wa=65535;this.ke=0;this.Ic=a.Ic;this.bd=a.bd;this.yd=a.Ae}Va.prototype.Jd=v();Va.prototype.Fc=B("s");Va.prototype.Dc=function(){65535!=this.Wa&&(this.V.xa.gb.Dc(this.Wa),this.Wa=65535)};Va.prototype.ye=v();function wa(){Qa.call(this);this.type=1;this.$=new P(1,1)}F(wa,Qa);wa.prototype.te=function(a){a.ga=new P(0,0);0==this.Nd&&(a.Mb=0,a.ga.n(0,0),a.fd=0);a.Mb=4*this.Nd*this.$.x*this.$.y;a.ga.n(0,0);a.fd=a.Mb/3*Na(this.$,this.$)};function U(){this.next=this.r=this.Sb=this.na=s};function V(a){this.p=new U;this.q=new U;this.jb=a.type;this.s=this.F=s;this.i=a.za;this.g=a.Aa;this.la=a.la;this.zb=t;this.Lb=a.S}V.prototype.Fc=B("s");V.prototype.Nb=v();V.prototype.tb=C(t);function Wa(a){this.type=0;this.Aa=this.za=this.S=s;this.la=a};function ia(){Wa.call(this,t);this.type=0;this.Aa=this.za=this.S=s;this.target=new P;this.type=5;this.$e=0;this.sf=5;this.pf=0.7;this.Gd=1/60}F(ia,Wa);function Xa(){this.Mb=this.fd=0;this.ga=new P(0,0)};function Ya(){this.Ha=new T;this.ga=new P;this.$=new P};function Za(){this.K=new P;this.O=new P}Za.prototype.Gc=function(){var a=this.O.x,b=this.O.y,a=this.O.x,b=this.O.y,a=a-this.K.x,b=b-this.K.y;return a=0<=a&&0<=b&&this.K.Gc()&&this.O.Gc()};function $a(a,b,c){Va.call(this,a,b);this.Ka=new Za;this.ja=new T;this.Ca=new P;this.w=new Ya;var d=0,e;b=new Za;this.B=Array(8);this.Zb=Array(8);this.ib=Array(8);this.jb=2;var f=new T(a.xf);if(a instanceof wa){this.Ca.x=a.Db.x-c.x;this.Ca.y=a.Db.y-c.y;this.Xa=4;c=a.$.x;e=a.$.y;var d=Math.max(0,c-0.3),g=Math.max(0,e-0.3);a=this.B[0]=new P;a.x=f.a.x*c+f.b.x*e;a.y=f.a.y*c+f.b.y*e;a=this.B[1]=new P;a.x=f.a.x*-c+f.b.x*e;a.y=f.a.y*-c+f.b.y*e;a=this.B[2]=new P;a.x=f.a.x*-c+f.b.x*-e;a.y=f.a.y*-c+f.b.y*-e;
a=this.B[3]=new P;a.x=f.a.x*c+f.b.x*-e;a.y=f.a.y*c+f.b.y*-e;a=this.Zb[0]=new P;a.x=f.a.x*d+f.b.x*g;a.y=f.a.y*d+f.b.y*g;a=this.Zb[1]=new P;a.x=f.a.x*-d+f.b.x*g;a.y=f.a.y*-d+f.b.y*g;a=this.Zb[2]=new P;a.x=f.a.x*-d+f.b.x*-g;a.y=f.a.y*-d+f.b.y*-g;a=this.Zb[3]=new P;a.x=f.a.x*d+f.b.x*-g;a.y=f.a.y*d+f.b.y*-g}else{this.Xa=a.Wf;d=a.ff;e=a.Wf;for(var g=ab,h=0,j=0,k=0,l=1/3,n=0;n<e;++n)var q=d[n].x,r=d[n].y,u=n+1<e?d[n+1].x:d[0].x,A=n+1<e?d[n+1].y:d[0].y,y=0.5*((q-0)*(A-0)-(r-0)*(u-0)),k=k+y,h=h+y*l*(0+q+u),
j=j+y*l*(0+r+A);g.n(h*(1/k),j*(1/k));g=ab.x;h=ab.y;this.Ca.x=a.Db.x+(f.a.x*g+f.b.x*h)-c.x;this.Ca.y=a.Db.y+(f.a.y*g+f.b.y*h)-c.y;for(d=0;d<this.Xa;++d)this.B[d]=new P,this.Zb[d]=new P,c=a.ff[d].x-g,e=a.ff[d].y-h,this.B[d].x=f.a.x*c+f.b.x*e,this.B[d].y=f.a.y*c+f.b.y*e,c=this.B[d].x,e=this.B[d].y,j=Math.sqrt(c*c+e*e),j>Number.MIN_VALUE&&(c*=1/j,e*=1/j),this.Zb[d].x=this.B[d].x-0.3*c,this.Zb[d].y=this.B[d].y-0.3*e}a=f=Number.MAX_VALUE;c=-Number.MAX_VALUE;e=-Number.MAX_VALUE;for(d=this.ke=0;d<this.Xa;++d)g=
this.B[d],f=Math.min(f,g.x),a=Math.min(a,g.y),c=Math.max(c,g.x),e=Math.max(e,g.y),this.ke=Math.max(this.ke,O(g));d=this.w.Ha;d.a.x=1;d.b.x=0;d.a.y=0;d.b.y=1;this.w.ga.n(0.5*(f+c),0.5*(a+e));this.w.$.n(0.5*(c-f),0.5*(e-a));for(d=a=f=0;d<this.Xa;++d)this.ib[d]=new P,f=d,a=d+1<this.Xa?d+1:0,this.ib[d].x=this.B[a].y-this.B[f].y,this.ib[d].y=-(this.B[a].x-this.B[f].x),f=this.ib[d],a=O(f),a<Number.MIN_VALUE||(a=1/a,f.x*=a,f.y*=a);for(d=0;d<this.Xa;++d);Sa(this.e,this.V.e);this.c.x=this.V.c.x+(this.e.a.x*
this.Ca.x+this.e.b.x*this.Ca.y);this.c.y=this.V.c.y+(this.e.a.y*this.Ca.x+this.e.b.y*this.Ca.y);W.a.x=this.e.a.x*this.w.Ha.a.x+this.e.b.x*this.w.Ha.a.y;W.a.y=this.e.a.y*this.w.Ha.a.x+this.e.b.y*this.w.Ha.a.y;W.b.x=this.e.a.x*this.w.Ha.b.x+this.e.b.x*this.w.Ha.b.y;W.b.y=this.e.a.y*this.w.Ha.b.x+this.e.b.y*this.w.Ha.b.y;W.ic();c=W.a.x*this.w.$.x+W.b.x*this.w.$.y;e=W.a.y*this.w.$.x+W.b.y*this.w.$.y;f=this.c.x+(this.e.a.x*this.w.ga.x+this.e.b.x*this.w.ga.y);a=this.c.y+(this.e.a.y*this.w.ga.x+this.e.b.y*
this.w.ga.y);b.K.x=f-c;b.K.y=a-e;b.O.x=f+c;b.O.y=a+e;f=this.V.xa.gb;this.Wa=bb(f,b)?cb(f,b,this):65535;65535==this.Wa&&db(this.V)}F($a,Va);$a.prototype.Ka=new Za;$a.prototype.ja=new T;
$a.prototype.ye=function(a,b,c,d){Sa(this.e,d);this.c.x=this.V.c.x+(d.a.x*this.Ca.x+d.b.x*this.Ca.y);this.c.y=this.V.c.y+(d.a.y*this.Ca.x+d.b.y*this.Ca.y);if(65535!=this.Wa){var e,f;e=b.a;f=b.b;var g=this.w.Ha.a,h=this.w.Ha.b;this.ja.a.x=e.x*g.x+f.x*g.y;this.ja.a.y=e.y*g.x+f.y*g.y;this.ja.b.x=e.x*h.x+f.x*h.y;this.ja.b.y=e.y*h.x+f.y*h.y;this.ja.ic();e=this.Ca.x+this.w.ga.x;f=this.Ca.y+this.w.ga.y;g=a.x+(b.a.x*e+b.b.x*f);a=a.y+(b.a.y*e+b.b.y*f);e=this.ja.a.x*this.w.$.x+this.ja.b.x*this.w.$.y;f=this.ja.a.y*
this.w.$.x+this.ja.b.y*this.w.$.y;this.Ka.K.x=g-e;this.Ka.K.y=a-f;this.Ka.O.x=g+e;this.Ka.O.y=a+f;e=d.a;f=d.b;g=this.w.Ha.a;h=this.w.Ha.b;this.ja.a.x=e.x*g.x+f.x*g.y;this.ja.a.y=e.y*g.x+f.y*g.y;this.ja.b.x=e.x*h.x+f.x*h.y;this.ja.b.y=e.y*h.x+f.y*h.y;this.ja.ic();e=this.Ca.x+this.w.ga.x;f=this.Ca.y+this.w.ga.y;g=c.x+(d.a.x*e+d.b.x*f);a=c.y+(d.a.y*e+d.b.y*f);e=this.ja.a.x*this.w.$.x+this.ja.b.x*this.w.$.y;f=this.ja.a.y*this.w.$.x+this.ja.b.y*this.w.$.y;this.Ka.K.x=Math.min(this.Ka.K.x,g-e);this.Ka.K.y=
Math.min(this.Ka.K.y,a-f);this.Ka.O.x=Math.max(this.Ka.O.x,g+e);this.Ka.O.y=Math.max(this.Ka.O.y,a+f);c=this.V.xa.gb;if(bb(c,this.Ka)){d=this.Wa;h=this.Ka;b=a=0;var j,k;j=0;var l;if(!(65535==d||1024<=d)&&h.Gc()!=t){e=2*c.cc;f=c.Ga[d];g=new eb;fb(c,g.nd,g.Hd,h);var n=new eb;for(a=0;2>a;++a)n.nd[a]=c.fb[a][f.ka[a]].value,n.Hd[a]=c.fb[a][f.La[a]].value;for(a=0;2>a;++a){var q=c.fb[a],r=f.ka[a],u=f.La[a],A=g.nd[a],y=g.Hd[a],w=A-q[r].value,x=y-q[u].value;q[r].value=A;q[u].value=y;if(0>w)for(b=r;0<b&&A<
q[b-1].value;)h=q[b],j=q[b-1],k=j.D,l=c.Ga[j.D],j.z++,1==(j.value&1)==m?(gb(c,g,l)&&hb(c.sb,d,k),l.La[a]++,h.z++):(l.ka[a]++,h.z--),f.ka[a]--,ib(h,j),--b;if(0<x)for(b=u;b<e-1&&q[b+1].value<=y;)h=q[b],k=q[b+1],j=k.D,l=c.Ga[j],k.z++,0==(k.value&1)==m?(gb(c,g,l)&&hb(c.sb,d,j),l.ka[a]--,h.z++):(l.La[a]--,h.z--),f.La[a]++,ib(h,k),b++;if(0<w)for(b=r;b<e-1&&q[b+1].value<=A;)h=q[b],k=q[b+1],j=k.D,l=c.Ga[j],k.z--,1==(k.value&1)?(gb(c,n,l)&&jb(c.sb,d,j),l.La[a]--,h.z--):(l.ka[a]--,h.z++),f.ka[a]++,ib(h,k),
b++;if(0>x)for(b=u;0<b&&y<q[b-1].value;)h=q[b],j=q[b-1],k=j.D,l=c.Ga[k],j.z--,0==(j.value&1)==m?(gb(c,n,l)&&jb(c.sb,d,k),l.ka[a]++,h.z--):(l.La[a]++,h.z++),f.La[a]--,ib(h,j),b--}}}else db(this.V)}};
$a.prototype.Jd=function(a){if(65535!=this.Wa){a.Dc(this.Wa);var b=new T(0,kb(this.e,this.w.Ha.a),kb(this.e,this.w.Ha.b)),b=new T(0,new P(Math.abs(b.a.x),Math.abs(b.a.y)),new P(Math.abs(b.b.x),Math.abs(b.b.y))),b=kb(b,this.w.$),c=kb(this.e,this.w.ga);c.add(this.c);var d=new Za;Q(d.K,c);var e=d.K;e.x-=b.x;e.y-=b.y;Q(d.O,c);d.O.add(b);this.Wa=bb(a,d)?cb(a,d,this):65535;65535==this.Wa&&db(this.V)}};var ab=new P,W=new T;function kb(a,b){return new P(a.a.x*b.x+a.b.x*b.y,a.a.y*b.x+a.b.y*b.y)}function X(a,b,c){return Math.max(b,Math.min(a,c))};function lb(a,b){this.df=new T;this.c=new P;Q(this.c,a.position);this.oe=new P;Q(this.oe,this.c);var c=0,d,e;this.o=0;this.l=a.rotation;this.e=new T(0);this.e.n(this.l);this.Xe=this.l;this.xa=b;this.Rf=X(1-a.vf,0,1);this.Lf=X(1-a.of,0,1);this.Vc=new P(0,0);this.Da=this.Ye=0;for(var f=Array(64),c=0;64>c;c++)f[c]=new Xa;this.fc=0;this.hb=new P(0,0);for(c=0;64>c;++c){d=a.Bc[c];if(d==s)break;e=f[c];d.te(e);this.Da+=e.Mb;this.hb.x+=e.Mb*(d.Db.x+e.ga.x);this.hb.y+=e.Mb*(d.Db.y+e.ga.y);++this.fc}0<this.Da?
(this.hb.scale(1/this.Da),this.c.add(kb(this.e,this.hb))):this.o|=mb;for(c=this.Vb=0;c<this.fc;++c)d=a.Bc[c],e=f[c],this.Vb+=e.fd,d=new P(Pa(d.Db,e.ga).x-this.hb.x,Pa(d.Db,e.ga).y-this.hb.y),this.Vb+=e.Mb*Na(d,d);this.h=0<this.Da?1/this.Da:0;this.m=0<this.Vb&&a.Tf==t?1/this.Vb:this.Vb=0;this.d=Pa(a.wf,new P(-a.Ld*this.hb.y,a.Ld*this.hb.x));this.f=a.Ld;this.gc=this.s=this.F=this.W=this.Z=s;for(c=0;c<this.fc;++c){d=a.Bc[c];e=d;f=this.hb;if(e instanceof wa)e=new $a(e,this,f);else throw"unsupported ShapeDef";
e.s=this.gc;this.gc=e}this.zc=0;a.nf&&(this.o|=nb);a.tf&&(this.o|=Y);if(this.o&Y||0==this.h)this.d.n(0,0),this.f=0;this.Lb=a.S}function ma(a){a.o&=~Y;a.zc=0}lb.prototype.Fc=B("s");function db(a){a.o|=ob;a.d.ra();a.f=0;for(a=a.gc;a!=s;a=a.s)a.Dc()}var mb=1,ob=2,Y=8,nb=16;var pb=new (v());function qb(){this.se=this.dg=this.Md=s};function Z(){this.next=this.r=this.sa=this.na=s};function rb(a,b){this.p=new Z;this.q=new Z;this.o=0;!a||!b?this.R=this.Q=s:(this.Q=a,this.R=b,this.Oa=0,this.Ba=Math.sqrt(this.Q.Ba*this.R.Ba),this.Ea=Math.max(this.Q.Ea,this.R.Ea),this.s=this.F=s,this.p.sa=s,this.p.r=s,this.p.next=s,this.p.na=s,this.q.sa=s,this.q.r=s,this.q.next=s,this.q.na=s)}rb.prototype.jc=C(s);rb.prototype.Fc=B("s");rb.prototype.Ec=v();function sb(a){this.bg=a;this.kf=this.mf=this.lf=this.$f=0};function tb(){this.Ob=0;this.T=new sb(this)}tb.prototype.n=function(a){ub(this,a.Ob)};tb.prototype.Id=function(){var a=new tb;ub(a,this.Ob);return a};function ub(a,b){a.Ob=b;a.T.mf=a.Ob&255;a.T.ag=(a.Ob&65280)>>8&255;a.T.lf=(a.Ob&16711680)>>16&255;a.T.kf=(a.Ob&4278190080)>>24&255};function vb(){this.position=new P;this.id=new tb;this.oa=this.ia=this.kb=s};function wb(){this.P=0;this.Y=Array(2);for(var a=0;2>a;a++)this.Y[a]=new vb;this.C=new P};function xb(a,b){this.p=new Z;this.q=new Z;this.o=0;!a||!b?this.R=this.Q=s:(this.Q=a,this.R=b,this.Oa=0,this.Ba=Math.sqrt(this.Q.Ba*this.R.Ba),this.Ea=Math.max(this.Q.Ea,this.R.Ea),this.s=this.F=s,this.p.sa=s,this.p.r=s,this.p.next=s,this.p.na=s,this.q.sa=s,this.q.r=s,this.q.next=s,this.q.na=s,this.od=new wb,this.wa=[new wb],this.wa[0].P=0)}F(xb,rb);
xb.prototype.Ec=function(){for(var a=this.wa[0],b=this.od.Y,c=0;c<a.P;c++){var d=b[c],e=a.Y[c];d.ia=e.ia;d.oa=e.oa;d.id=e.id.Id()}this.od.P=a.P;var c=this.Q,f=this.R;a.P=0;var g,b=[0],d=yb(b,c,f);g=b[0];if(!(0<d)){var h,b=[0],j=yb(b,f,c);h=b[0];if(!(0<j)){b=e=0;j>0.98*d+0.0010?(d=f,j=c,e=h,b=1):(d=c,j=f,e=g,b=0);c=[new zb,new zb];f=e;g=j;var k=d.B,j=g.Xa;h=g.B;for(var l=k[f+1==d.Xa?0:f+1],n=l.x,q=l.y,l=k[f],n=n-l.x,q=q-l.y,l=n,n=q,q=-l,l=1/Math.sqrt(n*n+q*q),n=n*l,r=q*l,l=n,k=d.e,n=k.a.x*l+k.b.x*
r,r=k.a.y*l+k.b.y*r,q=n,n=r,k=g.e,l=q*k.a.x+n*k.a.y,n=q*k.b.x+n*k.b.y,q=l,r=k=0,u=Number.MAX_VALUE,A=0;A<j;++A){var y=A,w=A+1<j?A+1:0,l=h[w],x=l.x,z=l.y,l=h[y],x=x-l.x,z=z-l.y,l=x,x=z,z=-l,l=1/Math.sqrt(x*x+z*z),x=x*l,z=z*l,l=x*q+z*n;l<u&&(u=l,k=y,r=w)}j=c[0];l=j.Bb;Q(l,h[k]);Oa(l,g.e);l.add(g.c);j.id.T.Ed=f;j.id.T.Kc=k;j.id.T.mc=k;j=c[1];l=j.Bb;Q(l,h[r]);Oa(l,g.e);l.add(g.c);j.id.T.Ed=f;j.id.T.Kc=k;j.id.T.mc=r;f=d.B;l=f[e];q=e+1<d.Xa?f[e+1]:f[0];g=q.x-l.x;h=q.y-l.y;n=g;k=d.e;g=k.a.x*n+k.b.x*h;h=
k.a.y*n+k.b.y*h;e=1/Math.sqrt(g*g+h*h);g*=e;h*=e;n=g;e=h;f=-n;j=l.x;r=l.y;n=j;k=d.e;j=k.a.x*n+k.b.x*r;r=k.a.y*n+k.b.y*r;j+=d.c.x;r+=d.c.y;l=q.x;q=q.y;n=l;k=d.e;l=k.a.x*n+k.b.x*q;q=k.a.y*n+k.b.y*q;l+=d.c.x;q+=d.c.y;d=e*j+f*r;n=-(g*j+h*r);l=g*l+h*q;q=[new zb,new zb];j=[new zb,new zb];k=0;Ab.n(-g,-h);k=Bb(q,c,n);if(!(2>k)&&(Ab.n(g,h),k=Bb(j,q,l),!(2>k))){b?a.C.n(-e,-f):a.C.n(e,f);for(g=c=0;2>g;++g)h=j[g].Bb,h=e*h.x+f*h.y-d,0>=h&&(l=a.Y[c],l.kb=h,Q(l.position,j[g].Bb),l.id.n(j[g].id),l.id.T.Od=b,++c);
a.P=c}}}if(0<a.P){b=[t,t];for(c=0;c<a.P;++c){d=a.Y[c];d.ia=0;d.oa=0;e=d.id.key;for(f=0;f<this.od.P;++f)if(b[f]!=m&&(g=this.od.Y[f],g.id.key==e)){b[f]=m;d.ia=g.ia;d.oa=g.oa;break}}this.Oa=1}else this.Oa=0};xb.prototype.jc=B("wa");function Cb(a,b){return new xb(a,b)};function Db(a,b){this.p=new Z;this.q=new Z;this.o=0;!a||!b?this.R=this.Q=s:(this.Q=a,this.R=b,this.Oa=0,this.Ba=Math.sqrt(this.Q.Ba*this.R.Ba),this.Ea=Math.max(this.Q.Ea,this.R.Ea),this.s=this.F=s,this.p.sa=s,this.p.r=s,this.p.next=s,this.p.na=s,this.q.sa=s,this.q.r=s,this.q.next=s,this.q.na=s,this.wa=[new wb],this.wa[0].P=0,this.wa[0].Y[0].ia=0,this.wa[0].Y[0].oa=0)}F(Db,rb);
Db.prototype.Ec=function(){a:{var a=this.wa[0],b=this.Q,c=this.R;a.P=0;var d,e,f;e=c.c.x-b.c.x;f=c.c.y-b.c.y;var g=b.e,h=e*g.a.x+f*g.a.y;f=e*g.b.x+f*g.b.y;e=h;var j=0,k=-Number.MAX_VALUE,h=c.Cd;for(d=0;d<b.Xa;++d){var l=b.ib[d].x*(e-b.B[d].x)+b.ib[d].y*(f-b.B[d].y);if(l>h)break a;l>k&&(k=l,j=d)}if(k<Number.MIN_VALUE)a.P=1,f=b.ib[j],a.C.x=g.a.x*f.x+g.b.x*f.y,a.C.y=g.a.y*f.x+g.b.y*f.y,d=a.Y[0],d.id.T.Kc=j,d.id.T.mc=255,d.id.T.Ed=255,d.id.T.Od=0,d.position.x=c.c.x-h*a.C.x,d.position.y=c.c.y-h*a.C.y,
d.kb=k-h;else{var k=j+1<b.Xa?j+1:0,n=b.B[k].x-b.B[j].x,l=b.B[k].y-b.B[j].y,q=Math.sqrt(n*n+l*l),n=n/q,l=l/q;if(q<Number.MIN_VALUE)e-=b.B[j].x,f-=b.B[j].y,b=Math.sqrt(e*e+f*f),e/=b,f/=b,b>h||(a.P=1,a.C.n(g.a.x*e+g.b.x*f,g.a.y*e+g.b.y*f),d=a.Y[0],d.id.T.Kc=255,d.id.T.mc=j,d.id.T.Ed=255,d.id.T.Od=0,d.position.x=c.c.x-h*a.C.x,d.position.y=c.c.y-h*a.C.y,d.kb=b-h);else{var r=(e-b.B[j].x)*n+(f-b.B[j].y)*l;d=a.Y[0];d.id.T.Kc=255;d.id.T.mc=255;d.id.T.Ed=255;d.id.T.Od=0;0>=r?(n=b.B[j].x,b=b.B[j].y,d.id.T.mc=
j):r>=q?(n=b.B[k].x,b=b.B[k].y,d.id.T.mc=k):(n=n*r+b.B[j].x,b=l*r+b.B[j].y,d.id.T.Kc=j);e-=n;f-=b;b=Math.sqrt(e*e+f*f);e/=b;f/=b;b>h||(a.P=1,a.C.n(g.a.x*e+g.b.x*f,g.a.y*e+g.b.y*f),d.position.x=c.c.x-h*a.C.x,d.position.y=c.c.y-h*a.C.y,d.kb=b-h)}}}this.Oa=0<this.wa[0].P?1:0};Db.prototype.jc=B("wa");function Eb(a,b){return new Db(a,b)};function zb(){this.Bb=new P;this.id=new tb};function Bb(a,b,c){var d=Ab,e=0,f=b[0].Bb,g=b[1].Bb,h=Na(d,b[0].Bb)-c;c=Na(d,b[1].Bb)-c;0>=h&&(a[e++]=b[0]);0>=c&&(a[e++]=b[1]);0>h*c&&(c=h/(h-c),d=a[e].Bb,d.x=f.x+c*(g.x-f.x),d.y=f.y+c*(g.y-f.y),a[e].id=0<h?b[0].id:b[1].id,++e);return e}
function Fb(a,b,c){for(var d=a.B,e=c.Xa,f=c.B,g=a.ib[b].x,h=a.ib[b].y,j=g,k=a.e,g=k.a.x*j+k.b.x*h,h=k.a.y*j+k.b.y*h,l=g,n=h,k=c.e,j=l*k.a.x+n*k.a.y,n=l*k.b.x+n*k.b.y,l=j,j=0,k=Number.MAX_VALUE,q=0;q<e;++q){var r=f[q],r=r.x*l+r.y*n;r<k&&(k=r,j=q)}k=a.e;e=a.c.x+(k.a.x*d[b].x+k.b.x*d[b].y);a=a.c.y+(k.a.y*d[b].x+k.b.y*d[b].y);k=c.e;b=c.c.x+(k.a.x*f[j].x+k.b.x*f[j].y);c=c.c.y+(k.a.y*f[j].x+k.b.y*f[j].y);return(b-e)*g+(c-a)*h}
function yb(a,b,c){for(var d=b.Xa,e=c.c.x-b.c.x,f=c.c.y-b.c.y,g=e*b.e.a.x+f*b.e.a.y,f=e*b.e.b.x+f*b.e.b.y,e=0,h=-Number.MAX_VALUE,j=0;j<d;++j){var k=b.ib[j].x*g+b.ib[j].y*f;k>h&&(h=k,e=j)}g=Fb(b,e,c);if(0<g)return g;j=0<=e-1?e-1:d-1;k=Fb(b,j,c);if(0<k)return k;var l=e+1<d?e+1:0,n=Fb(b,l,c);if(0<n)return n;h=f=0;if(k>g&&k>n)h=-1,f=j,j=k;else if(n>g)h=1,f=l,j=n;else return a[0]=e,g;for(;;){e=-1==h?0<=f-1?f-1:d-1:f+1<d?f+1:0;g=Fb(b,e,c);if(0<g)return g;if(g>j)f=e,j=g;else break}a[0]=f;return j}
var Ab=new P;function Gb(a,b){this.p=new Z;this.q=new Z;this.o=0;!a||!b?this.R=this.Q=s:(this.Q=a,this.R=b,this.Oa=0,this.Ba=Math.sqrt(this.Q.Ba*this.R.Ba),this.Ea=Math.max(this.Q.Ea,this.R.Ea),this.s=this.F=s,this.p.sa=s,this.p.r=s,this.p.next=s,this.p.na=s,this.q.sa=s,this.q.r=s,this.q.next=s,this.q.na=s,this.wa=[new wb],this.wa[0].P=0,this.wa[0].Y[0].ia=0,this.wa[0].Y[0].oa=0)}F(Gb,rb);
Gb.prototype.Ec=function(){var a=this.wa[0],b=this.Q,c=this.R;a.P=0;var d=c.c.x-b.c.x,e=c.c.y-b.c.y,f=d*d+e*e,b=b.Cd+c.Cd;if(!(f>b*b)){if(f<Number.MIN_VALUE)f=-b,a.C.n(0,1);else{var g=Math.sqrt(f),f=g-b,b=1/g;a.C.x=b*d;a.C.y=b*e}a.P=1;d=a.Y[0];ub(d.id,0);d.kb=f;d.position.x=c.c.x-c.Cd*a.C.x;d.position.y=c.c.y-c.Cd*a.C.y}this.Oa=0<this.wa[0].P?1:0};Gb.prototype.jc=B("wa");function Hb(a,b){return new Gb(a,b)};function Ib(a,b,c){$[b][c].Md=a;$[b][c].se=m;b!=c&&($[c][b].Md=a,$[c][b].se=t)}var $=s,Jb=t;function Kb(a,b){this.p=new Z;this.q=new Z;this.o=0;!a||!b?this.R=this.Q=s:(this.Q=a,this.R=b,this.Oa=0,this.Ba=Math.sqrt(this.Q.Ba*this.R.Ba),this.Ea=Math.max(this.Q.Ea,this.R.Ea),this.s=this.F=s,this.p.sa=s,this.p.r=s,this.p.next=s,this.p.na=s,this.q.sa=s,this.q.r=s,this.q.next=s,this.q.na=s)}F(Kb,rb);Kb.prototype.Ec=v();Kb.prototype.jc=C(s);function Lb(){}Lb.prototype.ue=C(s);Lb.prototype.ve=v();function Mb(a){this.me=new Kb;this.xa=a;this.fe=t}F(Mb,Lb);
Mb.prototype.ue=function(a,b){var c=a,d=b,e=c.V,f=d.V,g;if(!(g=(e.o&mb)==mb&&(f.o&mb)==mb||c.V==d.V))a:{for(g=f.Z;g!=s;g=g.next)if(g.na==e){g=g.Sb.la==t;break a}g=t}if(g||(c.yd==d.yd&&0!=c.yd?0<c.yd:0!=(c.bd&d.Ic)&&0!=(c.Ic&d.bd))==t)return this.me;0==f.h&&(e=c,c=d,d=e);if(Jb==t){$=Array(4);for(e=0;4>e;e++){$[e]=Array(4);for(f=0;4>f;f++)$[e][f]=new qb}Ib(Hb,0,0);Ib(Eb,2,0);Ib(Cb,2,2);Jb=m}e=c.jb;f=d.jb;if(g=$[e][f].Md)if($[e][f].se)d=g(c,d);else{d=g(d,c);for(c=0;c<d.Oa;++c)e=d.jc()[c],e.C=new P(-e.C.x,
-e.C.y)}else d=s;if(d==s)return this.me;d.F=s;d.s=this.xa.W;this.xa.W!=s&&(this.xa.W.F=d);this.xa.W=d;this.xa.Xb++;return d};Mb.prototype.ve=function(a,b,c){c!=s&&c!=this.me&&(this.fe==m?Nb(this,c):c.o|=2)};
function Nb(a,b){b.F&&(b.F.s=b.s);b.s&&(b.s.F=b.F);b==a.xa.W&&(a.xa.W=b.s);if(0<b.Oa){var c=b.Q.V,d=b.R.V,e=b.p,f=b.q;ma(c);ma(d);e.r&&(e.r.next=e.next);e.next&&(e.next.r=e.r);e==c.W&&(c.W=e.next);e.r=s;e.next=s;f.r&&(f.r.next=f.next);f.next&&(f.next.r=f.r);f==d.W&&(d.W=f.next);f.r=s;f.next=s}--a.xa.Xb};function Ob(){this.kd=new P;this.ld=new P;this.ed=this.kb=this.ef=this.re=this.cd=this.oa=this.ia=s};function Pb(){this.Fd=this.gd=this.Aa=this.za=this.Ze=s;this.P=0;this.C=new P;this.Y=Array(2);for(var a=0;2>a;a++)this.Y[a]=new Ob};function Qb(a,b){this.tc=[];for(var c=0,d,e,c=this.Wb=0;c<b;++c)this.Wb+=a[c].Oa;for(c=0;c<this.Wb;c++)this.tc[c]=new Pb;for(var f=0,c=0;c<b;++c)for(var g=a[c],h=g.Q.V,j=g.R.V,k=g.Oa,l=g.jc(),n=g.Ba,g=g.Ea,q=h.d.x,r=h.d.y,u=j.d.x,A=j.d.y,y=h.f,w=j.f,x=0;x<k;++x){var z=l[x],D=z.C.x,J=z.C.y,H=this.tc[f];H.za=h;H.Aa=j;H.Ze=z;H.C.x=D;H.C.y=J;H.P=z.P;H.gd=n;H.Fd=g;for(var N=0;N<H.P;++N){var G=z.Y[N],K=H.Y[N];K.ia=G.ia;K.oa=G.oa;K.kb=G.kb;var R=G.position.x-h.c.x,ka=G.position.y-h.c.y,la=G.position.x-j.c.x,
G=G.position.y-j.c.y;d=K.kd;e=h.e;d.x=R*e.a.x+ka*e.a.y;d.y=R*e.b.x+ka*e.b.y;d=K.ld;e=j.e;d.x=la*e.a.x+G*e.a.y;d.y=la*e.b.x+G*e.b.y;d=R*R+ka*ka;e=la*la+G*G;var Ja=R*D+ka*J,ea=la*D+G*J,S=h.h+j.h,S=S+(h.m*(d-Ja*Ja)+j.m*(e-ea*ea));K.re=1/S;ea=J;S=-D;Ja=R*ea+ka*S;ea=la*ea+G*S;S=h.h+j.h;S+=h.m*(d-Ja*Ja)+j.m*(e-ea*ea);K.ef=1/S;K.ed=0;0<K.kb&&(K.ed=-60*K.kb);R=H.C.x*(u+-w*G-q- -y*ka)+H.C.y*(A+w*la-r-y*R);-30>R&&(K.ed+=-H.Fd*R)}++f}}
Qb.prototype={Cb:function(){for(var a=0,b,c,d,e,f,g,h,j,k=0;k<this.Wb;++k){for(var l=this.tc[k],n=l.za,q=l.Aa,r=n.f,u=n.d,A=q.f,y=q.d,w=n.h,x=n.m,z=q.h,D=q.m,J=l.C.x,H=l.C.y,N=H,G=-J,K=l.P,a=0;a<K;++a)b=l.Y[a],f=n.e,g=b.kd,c=f.a.x*g.x+f.b.x*g.y,d=f.a.y*g.x+f.b.y*g.y,f=q.e,g=b.ld,e=f.a.x*g.x+f.b.x*g.y,f=f.a.y*g.x+f.b.y*g.y,g=y.x+-A*f-u.x- -r*d,h=y.y+A*e-u.y-r*c,g=-b.re*(g*J+h*H-b.ed),h=Math.max(b.ia+g,0),g=h-b.ia,j=g*J,g*=H,u.x-=w*j,u.y-=w*g,r-=x*(c*g-d*j),y.x+=z*j,y.y+=z*g,A+=D*(e*g-f*j),b.ia=h,g=
y.x+-A*f-u.x- -r*d,h=y.y+A*e-u.y-r*c,g=b.ef*-(g*N+h*G),h=l.gd*b.ia,h=X(b.oa+g,-h,h),g=h-b.oa,j=g*N,g*=G,u.x-=w*j,u.y-=w*g,r-=x*(c*g-d*j),y.x+=z*j,y.y+=z*g,A+=D*(e*g-f*j),b.oa=h;n.f=r;q.f=A}},tb:function(a){for(var b=0,c,d,e=0;e<this.Wb;++e){for(var f=this.tc[e],g=f.za,h=f.Aa,j=g.c,k=g.l,l=h.c,n=h.l,q=g.h,r=g.m,u=h.h,A=h.m,y=f.C.x,w=f.C.y,x=f.P,z=0;z<x;++z){var D=f.Y[z];c=g.e;d=D.kd;var J=c.a.x*d.x+c.b.x*d.y,H=c.a.y*d.x+c.b.y*d.y;c=h.e;d=D.ld;var N=c.a.x*d.x+c.b.x*d.y;c=c.a.y*d.x+c.b.y*d.y;d=(l.x+
N-(j.x+J))*y+(l.y+c-(j.y+H))*w+D.kb;b=Math.min(b,d);d=a*X(d+0.15,-6,0);d*=-D.re;var G=D.cd;D.cd=Math.max(G+d,0);d=D.cd-G;D=d*y;d*=w;j.x-=q*D;j.y-=q*d;k-=r*(J*d-H*D);g.e.n(k);l.x+=u*D;l.y+=u*d;n+=A*(N*d-c*D);h.e.n(n)}g.l=k;h.l=n}return-0.15<=b}};function Rb(a,b,c){var d=0;this.mg=a;this.ng=b;this.og=c;this.pb=this.Xb=this.Na=0;this.vb=Array(a);for(d=0;d<a;d++)this.vb[d]=s;this.ee=Array(b);for(d=0;d<b;d++)this.ee[d]=s;this.Wc=Array(c);for(d=0;d<c;d++)this.Wc[d]=s}
Rb.prototype.Kd=function(a,b){for(var c=0,d,c=0;c<this.Na;++c)d=this.vb[c],0!=d.h&&(d.d.add(new P(a.Ra*Pa(b,new P(d.h*d.Vc.x,d.h*d.Vc.y)).x,a.Ra*Pa(b,new P(d.h*d.Vc.x,d.h*d.Vc.y)).y)),d.f+=a.Ra*d.m*d.Ye,d.d.scale(d.Rf),d.f*=d.Lf,Q(d.oe,d.c),d.Xe=d.l);for(var e=new Qb(this.ee,this.Xb),f,g,c=0;c<e.Wb;++c){d=e.tc[c];var h=d.za,j=d.Aa,k=h.h,l=h.m,n=j.h,q=j.m,r=d.C.x,u=d.C.y,A=u,y=-r,w=0,x=0;if(Sb){x=d.P;for(w=0;w<x;++w){var z=d.Y[w],D=z.ia*r+z.oa*A,J=z.ia*u+z.oa*y;g=h.e;f=z.kd;var H=g.a.x*f.x+g.b.x*f.y,
N=g.a.y*f.x+g.b.y*f.y;g=j.e;f=z.ld;var G=g.a.x*f.x+g.b.x*f.y;f=g.a.y*f.x+g.b.y*f.y;h.f-=l*(H*J-N*D);h.d.x-=k*D;h.d.y-=k*J;j.f+=q*(G*J-f*D);j.d.x+=n*D;j.d.y+=n*J;z.cd=0}}else{x=d.P;for(w=0;w<x;++w)h=d.Y[w],h.ia=0,h.oa=0,h.cd=0}}for(c=0;c<this.pb;++c)this.Wc[c].Nb();for(c=0;c<a.Ud;++c){e.Cb();for(d=0;d<this.pb;++d)this.Wc[d].Cb(a)}for(c=0;c<this.Na;++c)d=this.vb[c],0!=d.h&&(d.c.x+=a.Ra*d.d.x,d.c.y+=a.Ra*d.d.y,d.l+=a.Ra*d.f,d.e.n(d.l));for(c=0;c<this.pb;++c);if(Tb)for(Ub=0;Ub<a.Ud;++Ub){d=e.tb(0.2);
w=m;for(c=0;c<this.pb;++c)x=this.Wc[c].tb(),w=w&&x;if(d&&w)break}for(c=0;c<e.Wb;++c){d=e.tc[c];w=d.Ze;for(x=0;x<d.P;++x)h=w.Y[x],j=d.Y[x],h.ia=j.ia,h.oa=j.oa}for(c=0;c<this.Na;++c)if(d=this.vb[c],0!=d.h){d.e.n(d.l);e=d;e.df.n(e.Xe);for(w=e.gc;w!=s;w=w.s)w.ye(e.oe,e.df,e.c,e.e);d.Vc.n(0,0);d.Ye=0}};var Ub=0;function Vb(){this.Td=this.Ra=s;this.Ud=0};function Wb(){}Wb.prototype={Ia:0,Ja:0,next:0,status:0};Wb.prototype.ze=s;function Xb(){this.Ja=this.Ia=0};function Yb(){var a=0;this.$b=Array(8192);for(a=0;8192>a;++a)this.$b[a]=65535;this.ma=Array(8192);for(a=0;8192>a;++a)this.ma[a]=new Wb;this.bb=Array(8192);for(a=0;8192>a;++a)this.bb[a]=new Xb;for(a=0;8192>a;++a)this.ma[a].Ia=65535,this.ma[a].Ja=65535,this.ma[a].S=s,this.ma[a].status=0,this.ma[a].next=a+1;this.ma[8191].next=65535;this.ne=0}Yb.prototype={gb:s,de:s,vd:0,ne:0,bb:s,Ib:0,$b:s};
function jb(a,b,c){b=Zb(a,b,c);b!=s&&(1==(b.status&1)==t&&(b.status|=1,a.bb[a.Ib].Ia=b.Ia,a.bb[a.Ib].Ja=b.Ja,++a.Ib),b.status|=2)}function hb(a,b,c){if(b>c){var d=b;b=c;c=d}var d=$b(b,c)&8191,e=ac(a,b,c,d);if(e==s){var f=a.vd,e=a.ma[f];a.vd=e.next;e.Ia=b;e.Ja=c;e.status=0;e.S=s;e.next=a.$b[d];a.$b[d]=f;++a.ne}b=e;1==(b.status&1)==t&&(b.status|=1,a.bb[a.Ib].Ia=b.Ia,a.bb[a.Ib].Ja=b.Ja,++a.Ib);b.status&=-3}function Zb(a,b,c){if(b>c){var d=b;b=c;c=d}return ac(a,b,c,$b(b,c)&8191)}
function ac(a,b,c,d){for(d=a.$b[d];65535!=d&&(a.ma[d].Ia==b&&a.ma[d].Ja==c)==t;)d=a.ma[d].next;return 65535==d?s:a.ma[d]}
Yb.prototype.Cc=function(){for(var a=0,b=0,c=this.gb.Ga,d=[],a=0;a<this.Ib;++a){var e=Zb(this,this.bb[a].Ia,this.bb[a].Ja);e.status&=-2;var f=c[e.Ia],g=c[e.Ja];2==(e.status&2)?(4==(e.status&4)==m&&this.de.ve(f.S,g.S,e.S),this.bb[b].Ia=e.Ia,this.bb[b].Ja=e.Ja,++b):4==(e.status&4)==t&&(e.ze=this.de.ue(f.S,g.S),d.push(e.ze),e.status|=4)}for(a=0;a<b;++a)a:{c=this.bb[a].Ia;e=this.bb[a].Ja;c>e&&(f=c,c=e,e=f);for(var f=$b(c,e)&8191,g=this.$b[f],h=s;65535!=g;){if(this.ma[g].Ia==c&&this.ma[g].Ja==e){c=g;h?
h.next=this.ma[g].next:this.$b[f]=this.ma[g].next;e=this.ma[c];e.next=this.vd;e.Ia=65535;e.Ja=65535;e.S=s;e.status=0;this.vd=c;--this.ne;break a}h=this.ma[g];g=h.next}}this.Ib=0;return d};function $b(a,b){var c=b<<16&4294901760|a,c=~c+(c<<15&4294934528),c=c^c>>12&1048575,c=c+(c<<2&4294967292),c=2057*(c^c>>4&268435455);return c^=c>>16&65535};function bc(){this.z=this.D=this.value=0}function ib(a,b){var c=a.value,d=a.D,e=a.z;a.value=b.value;a.D=b.D;a.z=b.z;b.value=c;b.D=d;b.z=e};function cc(){this.ka=[0,0];this.La=[0,0];this.timeStamp=this.hc=0;this.S=s}cc.prototype={Fc:function(){return this.ka[0]},Gc:function(){return 65535!=this.hc}};function eb(){this.nd=[0,0];this.Hd=[0,0]};function dc(a,b){this.sb=new Yb;this.Ga=Array(8192);this.fb=Array(2048);this.$c=Array(1024);this.yc=new P;var c=0,c=this.sb;c.gb=this;c.de=b;this.Fa=a;for(c=this.cc=0;1024>c;c++)this.$c[c]=0;this.fb=Array(2);for(c=0;2>c;c++){this.fb[c]=Array(2048);for(var d=0;2048>d;d++)this.fb[c][d]=new bc}c=a.O.x;d=a.O.y;c-=a.K.x;d-=a.K.y;this.yc.x=65535/c;this.yc.y=65535/d;for(c=0;1023>c;++c)d=new cc,this.Ga[c]=d,d.ka[0]=c+1,d.timeStamp=0,d.hc=65535,d.S=s;d=new cc;this.Ga[1023]=d;d.ka[0]=65535;d.timeStamp=0;d.hc=
65535;d.S=s;this.wd=0;this.ad=1;this.Kb=0}function bb(a,b){var c,d,e,f;c=b.K.x;d=b.K.y;c-=a.Fa.O.x;d-=a.Fa.O.y;e=a.Fa.K.x;f=a.Fa.K.y;e-=b.O.x;f-=b.O.y;c=Math.max(c,e);d=Math.max(d,f);return 0>Math.max(c,d)}
dc.prototype.Dc=function(a){for(var b=this.Ga[a],c=2*this.cc,d=0;2>d;++d){for(var e=this.fb[d],f=b.ka[d],g=b.La[d],h=e[f].value,j=e[g].value,k=[],l=0,n=g-f-1,q,r,l=0;l<n;l++)k[l]=new bc,q=k[l],r=e[f+1+l],q.value=r.value,q.D=r.D,q.z=r.z;for(var n=k.length,u=f,l=0;l<n;l++)r=k[l],q=e[u+l],q.value=r.value,q.D=r.D,q.z=r.z;k=[];n=c-g-1;for(l=0;l<n;l++)k[l]=new bc,q=k[l],r=e[g+1+l],q.value=r.value,q.D=r.D,q.z=r.z;n=k.length;u=g-1;for(l=0;l<n;l++)r=k[l],q=e[u+l],q.value=r.value,q.D=r.D,q.z=r.z;n=c-2;for(k=
f;k<n;++k)l=this.Ga[e[k].D],0==(e[k].value&1)?l.ka[d]=k:l.La[d]=k;for(n=g-1;f<n;++f)e[f].z--;this.Hc([0],[0],h,j,e,c-2,d)}for(c=0;c<this.Kb;++c)jb(this.sb,a,this.$c[c]);this.sb.Cc();this.Kb=0;ec(this);b.S=s;b.hc=65535;b.ka[0]=65535;b.ka[1]=65535;b.La[0]=65535;b.La[1]=65535;b.ka[0]=this.wd;this.wd=a;--this.cc};
function fb(a,b,c,d){var e=d.K.x,f=d.K.y,e=Math.min(e,a.Fa.O.x),f=Math.min(f,a.Fa.O.y),e=Math.max(e,a.Fa.K.x),f=Math.max(f,a.Fa.K.y),g=d.O.x;d=d.O.y;g=Math.min(g,a.Fa.O.x);d=Math.min(d,a.Fa.O.y);g=Math.max(g,a.Fa.K.x);d=Math.max(d,a.Fa.K.y);b[0]=a.yc.x*(e-a.Fa.K.x)&65534;c[0]=a.yc.x*(g-a.Fa.K.x)&65535|1;b[1]=a.yc.y*(f-a.Fa.K.y)&65534;c[1]=a.yc.y*(d-a.Fa.K.y)&65535|1}function gb(a,b,c){for(var d=0;2>d;++d){var e=a.fb[d];if(b.nd[d]>e[c.La[d]].value||b.Hd[d]<e[c.ka[d]].value)return t}return m}
dc.prototype.Hc=function(a,b,c,d,e,f,g){c=fc(e,f,c);d=fc(e,f,d);for(f=c;f<d;++f)0==(e[f].value&1)&&gc(this,e[f].D);if(0<c){f=c-1;for(var h=e[f].z;h;)0==(e[f].value&1)&&c<=this.Ga[e[f].D].La[g]&&(gc(this,e[f].D),--h),--f}a[0]=c;b[0]=d};function gc(a,b){var c=a.Ga[b];c.timeStamp<a.ad?(c.timeStamp=a.ad,c.hc=1):(c.hc=2,a.$c[a.Kb]=b,++a.Kb)}function ec(a){if(65535==a.ad){for(var b=0;1024>b;++b)a.Ga[b].timeStamp=0;a.ad=1}else++a.ad}dc.prototype.Cc=function(){return this.sb.Cc()};
function cb(a,b,c){var d=0,e,f=a.wd;e=a.Ga[f];a.wd=e.Fc();e.hc=0;e.S=c;c=2*a.cc;e=[];var g=[];fb(a,e,g,b);for(b=0;2>b;++b){var h=a.fb[b],j=0,k=0,j=[j],k=[k];a.Hc(j,k,e[b],g[b],h,c,b);for(var j=j[0],k=k[0],d=[],l=0,n=c-k,q,r,l=0;l<n;l++)d[l]=new bc,q=d[l],r=h[k+l],q.value=r.value,q.D=r.D,q.z=r.z;for(var n=d.length,u=k+2,l=0;l<n;l++)r=d[l],q=h[u+l],q.value=r.value,q.D=r.D,q.z=r.z;d=[];n=k-j;for(l=0;l<n;l++)d[l]=new bc,q=d[l],r=h[j+l],q.value=r.value,q.D=r.D,q.z=r.z;n=d.length;u=j+1;for(l=0;l<n;l++)r=
d[l],q=h[u+l],q.value=r.value,q.D=r.D,q.z=r.z;++k;h[j].value=e[b];h[j].D=f;h[k].value=g[b];h[k].D=f;h[j].z=0==j?0:h[j-1].z;h[k].z=h[k-1].z;for(d=j;d<k;++d)h[d].z++;for(d=j;d<c+2;++d)j=a.Ga[h[d].D],0==(h[d].value&1)?j.ka[b]=d:j.La[b]=d}++a.cc;for(c=0;c<a.Kb;++c)hb(a.sb,f,a.$c[c]);a.sb.Cc();a.Kb=0;ec(a);return f}function fc(a,b,c){var d=0;for(b-=1;d<=b;){var e=Math.floor((d+b)/2);if(a[e].value>c)b=e-1;else if(a[e].value<c)d=e+1;else return e}return d};function hc(){this.L=new P;this.M=new P}hc.prototype={ca:s,da:s,ra:function(){this.L.ra();this.ca=0;this.M.ra();this.da=0},n:function(a,b,c,d){Q(this.L,a);this.ca=b;Q(this.M,c);this.da=d}};function ic(a,b,c,d,e){return a.L.x*b.x+a.L.y*b.y+a.ca*c+(a.M.x*d.x+a.M.y*d.y)+a.da*e};function jc(a){this.p=new U;this.q=new U;this.jb=a.type;this.s=this.F=s;this.i=a.za;this.g=a.Aa;this.la=a.la;this.zb=t;this.Lb=a.S;this.j=new P;this.k=new P;this.va=new P;this.rb=new P;this.J=new hc;this.A=new hc;var b,c,d;b=this.i.e;c=a.Pb.x-this.i.c.x;d=a.Pb.y-this.i.c.y;this.j.n(c*b.a.x+d*b.a.y,c*b.b.x+d*b.b.y);b=this.g.e;c=a.Pb.x-this.g.c.x;d=a.Pb.y-this.g.c.y;this.k.n(c*b.a.x+d*b.a.y,c*b.b.x+d*b.b.y);b=this.i.e;c=a.axis.x;d=a.axis.y;this.va.n(c*b.a.x+d*b.a.y,c*b.b.x+d*b.b.y);this.rb.x=-this.va.y;
this.rb.y=this.va.x;this.Pf=this.g.l-this.i.l;this.J.ra();this.Tc=this.ce=this.Ab=this.Zc=0;this.A.ra();this.ha=this.v=this.ea=this.Pa=0;this.je=a.fg;this.qe=a.vg;this.Ue=a.rg;this.le=a.Sf;this.wb=a.qf;this.uc=a.rf}F(jc,V);function kc(a){var b=a.i,c=a.g,d;d=b.e;var e=d.a.x*a.j.x+d.b.x*a.j.y,f=d.a.y*a.j.x+d.b.y*a.j.y;d=c.e;e=c.c.x+(d.a.x*a.k.x+d.b.x*a.k.y)-(b.c.x+e);c=c.c.y+(d.a.y*a.k.x+d.b.y*a.k.y)-(b.c.y+f);d=b.e;return(d.a.x*a.va.x+d.b.x*a.va.y)*e+(d.a.y*a.va.x+d.b.y*a.va.y)*c}
jc.prototype.Nb=function(){var a=this.i,b=this.g,c;c=a.e;var d=c.a.x*this.j.x+c.b.x*this.j.y,e=c.a.y*this.j.x+c.b.y*this.j.y;c=b.e;var f=c.a.x*this.k.x+c.b.x*this.k.y,g=c.a.y*this.k.x+c.b.y*this.k.y,h=a.h,j=b.h,k=a.m,l=b.m;c=a.e;var n=c.a.x*this.rb.x+c.b.x*this.rb.y;c=c.a.y*this.rb.x+c.b.y*this.rb.y;var q=b.c.x+f-a.c.x,r=b.c.y+g-a.c.y;this.J.L.x=-n;this.J.L.y=-c;this.J.M.x=n;this.J.M.y=c;this.J.ca=-(q*c-r*n);this.J.da=f*c-g*n;this.Zc=h+k*this.J.ca*this.J.ca+j+l*this.J.da*this.J.da;this.Zc=1/this.Zc;
this.ce=1/(k+l);if(this.wb||this.uc)c=a.e,n=c.a.x*this.va.x+c.b.x*this.va.y,c=c.a.y*this.va.x+c.b.y*this.va.y,this.A.L.x=-n,this.A.L.y=-c,this.A.M.x=n,this.A.M.y=c,this.A.ca=-(q*c-r*n),this.A.da=f*c-g*n,this.Pa=h+k*this.A.ca*this.A.ca+j+l*this.A.da*this.A.da,this.Pa=1/this.Pa,this.wb&&(d=n*(q-d)+c*(r-e),0.3>Math.abs(this.qe-this.je)?this.N=3:d<=this.je?(1!=this.N&&(this.v=0),this.N=1):d>=this.qe?(2!=this.N&&(this.v=0),this.N=2):this.v=this.N=0);this.uc==t&&(this.ea=0);this.wb==t&&(this.v=0);Sb?(d=
this.Ab*this.J.L.y+(this.ea+this.v)*this.A.L.y,e=this.Ab*this.J.M.x+(this.ea+this.v)*this.A.M.x,f=this.Ab*this.J.M.y+(this.ea+this.v)*this.A.M.y,g=this.Ab*this.J.ca-this.Tc+(this.ea+this.v)*this.A.ca,q=this.Ab*this.J.da+this.Tc+(this.ea+this.v)*this.A.da,a.d.x+=h*(this.Ab*this.J.L.x+(this.ea+this.v)*this.A.L.x),a.d.y+=h*d,a.f+=k*g,b.d.x+=j*e,b.d.y+=j*f,b.f+=l*q):this.ea=this.v=this.Tc=this.Ab=0;this.ha=0};
jc.prototype.Cb=function(a){var b=this.i,c=this.g,d=b.h,e=c.h,f=b.m,g=c.m,h=-this.Zc*ic(this.J,b.d,b.f,c.d,c.f);this.Ab+=h;b.d.x+=d*h*this.J.L.x;b.d.y+=d*h*this.J.L.y;b.f+=f*h*this.J.ca;c.d.x+=e*h*this.J.M.x;c.d.y+=e*h*this.J.M.y;c.f+=g*h*this.J.da;h=-this.ce*(c.f-b.f);this.Tc+=h;b.f-=f*h;c.f+=g*h;if(this.uc&&3!=this.N){var h=-this.Pa*(ic(this.A,b.d,b.f,c.d,c.f)-this.le),j=this.ea;this.ea=X(this.ea+h,-a.Ra*this.Ue,a.Ra*this.Ue);h=this.ea-j;b.d.x+=d*h*this.A.L.x;b.d.y+=d*h*this.A.L.y;b.f+=f*h*this.A.ca;
c.d.x+=e*h*this.A.M.x;c.d.y+=e*h*this.A.M.y;c.f+=g*h*this.A.da}this.wb&&0!=this.N&&(h=-this.Pa*ic(this.A,b.d,b.f,c.d,c.f),3==this.N?this.v+=h:1==this.N?(a=this.v,this.v=Math.max(this.v+h,0),h=this.v-a):2==this.N&&(a=this.v,this.v=Math.min(this.v+h,0),h=this.v-a),b.d.x+=d*h*this.A.L.x,b.d.y+=d*h*this.A.L.y,b.f+=f*h*this.A.ca,c.d.x+=e*h*this.A.M.x,c.d.y+=e*h*this.A.M.y,c.f+=g*h*this.A.da)};
jc.prototype.tb=function(){var a,b,c=this.i,d=this.g,e=c.h,f=d.h,g=c.m,h=d.m;a=c.e;var j=a.a.x*this.j.x+a.b.x*this.j.y,k=a.a.y*this.j.x+a.b.y*this.j.y;a=d.e;var l=a.a.x*this.k.x+a.b.x*this.k.y;a=a.a.y*this.k.x+a.b.y*this.k.y;var j=c.c.x+j,k=c.c.y+k,l=d.c.x+l,n=d.c.y+a;a=c.e;var q=(a.a.x*this.rb.x+a.b.x*this.rb.y)*(l-j)+(a.a.y*this.rb.x+a.b.y*this.rb.y)*(n-k),q=X(q,-6,6);b=-this.Zc*q;c.c.x+=e*b*this.J.L.x;c.c.y+=e*b*this.J.L.y;c.l+=g*b*this.J.ca;d.c.x+=f*b*this.J.M.x;d.c.y+=f*b*this.J.M.y;d.l+=h*b*
this.J.da;q=Math.abs(q);b=d.l-c.l-this.Pf;b=X(b,-Ia,Ia);var r=-this.ce*b;c.l-=c.m*r;c.e.n(c.l);d.l+=d.m*r;d.e.n(d.l);r=Math.abs(b);this.wb&&0!=this.N&&(a=c.e,j=a.a.x*this.j.x+a.b.x*this.j.y,k=a.a.y*this.j.x+a.b.y*this.j.y,a=d.e,l=a.a.x*this.k.x+a.b.x*this.k.y,a=a.a.y*this.k.x+a.b.y*this.k.y,j=c.c.x+j,k=c.c.y+k,l=d.c.x+l,n=d.c.y+a,a=c.e,j=(a.a.x*this.va.x+a.b.x*this.va.y)*(l-j)+(a.a.y*this.va.x+a.b.y*this.va.y)*(n-k),a=0,3==this.N?(a=X(j,-6,6),a*=-this.Pa,q=Math.max(q,Math.abs(b))):1==this.N?(a=j-
this.je,q=Math.max(q,-a),a=X(a+0.15,-6,0),a*=-this.Pa,b=this.ha,this.ha=Math.max(this.ha+a,0),a=this.ha-b):2==this.N&&(a=j-this.qe,q=Math.max(q,a),a=X(a-0.15,0,6),a*=-this.Pa,b=this.ha,this.ha=Math.min(this.ha+a,0),a=this.ha-b),c.c.x+=e*a*this.A.L.x,c.c.y+=e*a*this.A.L.y,c.l+=g*a*this.A.ca,c.e.n(c.l),d.c.x+=f*a*this.A.M.x,d.c.y+=f*a*this.A.M.y,d.l+=h*a*this.A.da,d.e.n(d.l));return 0.15>=q&&r<=Ha};function lc(a){this.p=new U;this.q=new U;this.jb=a.type;this.s=this.F=s;this.i=a.za;this.g=a.Aa;this.la=a.la;this.zb=t;this.Lb=a.S;this.ya=new T;this.pa=new T;this.qa=new T;this.qb=new P;this.Ac=new P;this.I=new P;this.Jb=new T;this.td=new P;Q(this.Ac,a.target);var b=this.Ac.x-this.g.c.x,c=this.Ac.y-this.g.c.y;this.qb.x=b*this.g.e.a.x+c*this.g.e.a.y;this.qb.y=b*this.g.e.b.x+c*this.g.e.b.y;this.Re=a.$e;this.I.ra();var c=this.g.Da,d=2*Ga*a.sf,b=2*c*a.pf*d,c=c*d*d;this.xd=1/(b+a.Gd*c);this.Ne=a.Gd*c/
(b+a.Gd*c)}F(lc,V);
lc.prototype.Nb=function(){var a=this.g,b;b=a.e;var c=b.a.x*this.qb.x+b.b.x*this.qb.y;b=b.a.y*this.qb.x+b.b.y*this.qb.y;var d=a.h,e=a.m;this.pa.a.x=d;this.pa.b.x=0;this.pa.a.y=0;this.pa.b.y=d;this.qa.a.x=e*b*b;this.qa.b.x=-e*c*b;this.qa.a.y=-e*c*b;this.qa.b.y=e*c*c;Sa(this.ya,this.pa);Ta(this.ya,this.qa);this.ya.a.x+=this.xd;this.ya.b.y+=this.xd;Ua(this.ya,this.Jb);this.td.x=a.c.x+c-this.Ac.x;this.td.y=a.c.y+b-this.Ac.y;a.f*=0.98;var f=this.I.x,g=this.I.y;a.d.x+=d*f;a.d.y+=d*g;a.f+=e*(c*g-b*f)};
lc.prototype.Cb=function(a){var b=this.g,c;c=b.e;var d=c.a.x*this.qb.x+c.b.x*this.qb.y,e=c.a.y*this.qb.x+c.b.y*this.qb.y,f=b.d.x+-b.f*e,g=b.d.y+b.f*d;c=this.Jb;var f=f+this.Ne*a.Td*this.td.x+this.xd*this.I.x,h=g+this.Ne*a.Td*this.td.y+this.xd*this.I.y,g=-(c.a.x*f+c.b.x*h),h=-(c.a.y*f+c.b.y*h);c=this.I.x;f=this.I.y;this.I.x+=g;this.I.y+=h;g=O(this.I);g>a.Ra*this.Re&&this.I.scale(a.Ra*this.Re/g);g=this.I.x-c;h=this.I.y-f;b.d.x+=b.h*g;b.d.y+=b.h*h;b.f+=b.m*(d*h-e*g)};lc.prototype.tb=C(m);function mc(a){this.p=new U;this.q=new U;this.jb=a.type;this.s=this.F=s;this.i=a.za;this.g=a.Aa;this.la=a.la;this.zb=t;this.Lb=a.S;this.xb=new P;this.yb=new P;this.j=new P;this.k=new P;this.G=new P;this.H=new P;var b,c,d;this.ab=this.i.xa.Oe;this.xb.x=a.Rd.x-this.ab.c.x;this.xb.y=a.Rd.y-this.ab.c.y;this.yb.x=a.Sd.x-this.ab.c.x;this.yb.y=a.Sd.y-this.ab.c.y;b=this.i.e;c=a.Qb.x-this.i.c.x;d=a.Qb.y-this.i.c.y;this.j.x=c*b.a.x+d*b.a.y;this.j.y=c*b.b.x+d*b.b.y;b=this.g.e;c=a.Rb.x-this.g.c.x;d=a.Rb.y-this.g.c.y;
this.k.x=c*b.a.x+d*b.a.y;this.k.y=c*b.b.x+d*b.b.y;this.X=a.Uf;c=a.Rd.x-a.Qb.x;d=a.Rd.y-a.Qb.y;b=Math.sqrt(c*c+d*d);c=a.Sd.x-a.Rb.x;d=a.Sd.y-a.Rb.y;c=Math.sqrt(c*c+d*d);d=Math.max(0.5*nc,b);c=Math.max(0.5*nc,c);this.Uc=d+this.X*c;this.Se=X(a.pg,d,this.Uc-this.X*nc);this.Te=X(a.qg,c,(this.Uc-nc)/this.X);this.bc=this.ac=this.xc=0}F(mc,V);
mc.prototype.Nb=function(){var a=this.i,b=this.g,c;c=a.e;var d=c.a.x*this.j.x+c.b.x*this.j.y,e=c.a.y*this.j.x+c.b.y*this.j.y;c=b.e;var f=c.a.x*this.k.x+c.b.x*this.k.y;c=c.a.y*this.k.x+c.b.y*this.k.y;var g=b.c.x+f,h=b.c.y+c,j=this.ab.c.x+this.yb.x,k=this.ab.c.y+this.yb.y;this.G.n(a.c.x+d-(this.ab.c.x+this.xb.x),a.c.y+e-(this.ab.c.y+this.xb.y));this.H.n(g-j,h-k);g=O(this.G);h=O(this.H);0.15<g?this.G.scale(1/g):this.G.ra();0.15<h?this.H.scale(1/h):this.H.ra();g<this.Se?this.ac=this.ge=0:(this.ge=2,this.zd=
0);h<this.Te?this.bc=this.he=0:(this.he=2,this.Ad=0);g=d*this.G.y-e*this.G.x;h=f*this.H.y-c*this.H.x;this.Xc=a.h+a.m*g*g;this.Yc=b.h+b.m*h*h;this.Bd=this.Xc+this.X*this.X*this.Yc;this.Xc=1/this.Xc;this.Yc=1/this.Yc;this.Bd=1/this.Bd;g=(-this.xc-this.ac)*this.G.x;h=(-this.xc-this.ac)*this.G.y;j=(-this.X*this.xc-this.bc)*this.H.x;k=(-this.X*this.xc-this.bc)*this.H.y;a.d.x+=a.h*g;a.d.y+=a.h*h;a.f+=a.m*(d*h-e*g);b.d.x+=b.h*j;b.d.y+=b.h*k;b.f+=b.m*(f*k-c*j)};
mc.prototype.Cb=function(){var a=this.i,b=this.g,c;c=a.e;var d=c.a.x*this.j.x+c.b.x*this.j.y,e=c.a.y*this.j.x+c.b.y*this.j.y;c=b.e;var f=c.a.x*this.k.x+c.b.x*this.k.y;c=c.a.y*this.k.x+c.b.y*this.k.y;var g,h,j,k;g=a.d.x+-a.f*e;h=a.d.y+a.f*d;j=b.d.x+-b.f*c;k=b.d.y+b.f*f;g=-(this.G.x*g+this.G.y*h)-this.X*(this.H.x*j+this.H.y*k);k=-this.Bd*g;this.xc+=k;g=-k*this.G.x;h=-k*this.G.y;j=-this.X*k*this.H.x;k=-this.X*k*this.H.y;a.d.x+=a.h*g;a.d.y+=a.h*h;a.f+=a.m*(d*h-e*g);b.d.x+=b.h*j;b.d.y+=b.h*k;b.f+=b.m*
(f*k-c*j);2==this.ge&&(g=a.d.x+-a.f*e,h=a.d.y+a.f*d,g=-(this.G.x*g+this.G.y*h),k=-this.Xc*g,g=this.ac,this.ac=Math.max(0,this.ac+k),k=this.ac-g,g=-k*this.G.x,h=-k*this.G.y,a.d.x+=a.h*g,a.d.y+=a.h*h,a.f+=a.m*(d*h-e*g));2==this.he&&(j=b.d.x+-b.f*c,k=b.d.y+b.f*f,g=-(this.H.x*j+this.H.y*k),k=-this.Yc*g,g=this.bc,this.bc=Math.max(0,this.bc+k),k=this.bc-g,j=-k*this.H.x,k=-k*this.H.y,b.d.x+=b.h*j,b.d.y+=b.h*k,b.f+=b.m*(f*k-c*j))};
mc.prototype.tb=function(){var a=this.i,b=this.g,c,d=this.ab.c.x+this.xb.x,e=this.ab.c.y+this.xb.y,f=this.ab.c.x+this.yb.x,g=this.ab.c.y+this.yb.y,h,j,k,l,n,q,r,u=0;c=a.e;h=c.a.x*this.j.x+c.b.x*this.j.y;j=c.a.y*this.j.x+c.b.y*this.j.y;c=b.e;k=c.a.x*this.k.x+c.b.x*this.k.y;c=c.a.y*this.k.x+c.b.y*this.k.y;l=a.c.x+h;n=a.c.y+j;q=b.c.x+k;r=b.c.y+c;this.G.n(l-d,n-e);this.H.n(q-f,r-g);l=O(this.G);n=O(this.H);0.15<l?this.G.scale(1/l):this.G.ra();0.15<n?this.H.scale(1/n):this.H.ra();l=this.Uc-l-this.X*n;u=
Math.max(u,Math.abs(l));l=X(l,-6,6);r=-this.Bd*l;l=-r*this.G.x;n=-r*this.G.y;q=-this.X*r*this.H.x;r=-this.X*r*this.H.y;a.c.x+=a.h*l;a.c.y+=a.h*n;a.l+=a.m*(h*n-j*l);b.c.x+=b.h*q;b.c.y+=b.h*r;b.l+=b.m*(k*r-c*q);a.e.n(a.l);b.e.n(b.l);2==this.ge&&(c=a.e,h=c.a.x*this.j.x+c.b.x*this.j.y,j=c.a.y*this.j.x+c.b.y*this.j.y,l=a.c.x+h,n=a.c.y+j,this.G.n(l-d,n-e),l=O(this.G),0.15<l?(this.G.x*=1/l,this.G.y*=1/l):this.G.ra(),l=this.Se-l,u=Math.max(u,-l),l=X(l+0.15,-6,0),r=-this.Xc*l,d=this.zd,this.zd=Math.max(0,
this.zd+r),r=this.zd-d,l=-r*this.G.x,n=-r*this.G.y,a.c.x+=a.h*l,a.c.y+=a.h*n,a.l+=a.m*(h*n-j*l),a.e.n(a.l));2==this.he&&(c=b.e,k=c.a.x*this.k.x+c.b.x*this.k.y,c=c.a.y*this.k.x+c.b.y*this.k.y,q=b.c.x+k,r=b.c.y+c,this.H.n(q-f,r-g),n=O(this.H),0.15<n?(this.H.x*=1/n,this.H.y*=1/n):this.H.ra(),l=this.Te-n,u=Math.max(u,-l),l=X(l+0.15,-6,0),r=-this.Yc*l,d=this.Ad,this.Ad=Math.max(0,this.Ad+r),r=this.Ad-d,q=-r*this.H.x,r=-r*this.H.y,b.c.x+=b.h*q,b.c.y+=b.h*r,b.l+=b.m*(k*r-c*q),b.e.n(b.l));return 0.15>u};
var nc=30;function oc(a){this.p=new U;this.q=new U;this.jb=a.type;this.s=this.F=s;this.i=a.za;this.g=a.Aa;this.la=a.la;this.zb=t;this.Lb=a.S;this.xb=new P;this.yb=new P;this.j=new P;this.k=new P;this.U=new hc;this.wc=this.ec=this.vc=this.dc=s;var b,c;this.Nf=a.hd.i;this.i=a.hd.g;1==a.hd.jb?(this.dc=a.hd,Q(this.xb,this.dc.j),Q(this.j,this.dc.k),b=pc(this.dc)):(this.vc=a.hd,Q(this.xb,this.vc.j),Q(this.j,this.vc.k),b=kc(this.vc));this.Of=a.jd.i;this.g=a.jd.g;1==a.jd.jb?(this.ec=a.jd,Q(this.yb,this.ec.j),Q(this.k,
this.ec.k),c=pc(this.ec)):(this.wc=a.jd,Q(this.yb,this.wc.j),Q(this.k,this.wc.k),c=kc(this.wc));this.X=a.Uf;this.Uc=b+this.X*c;this.I=0}F(oc,V);
oc.prototype.Nb=function(){var a=this.Nf,b=this.Of,c=this.i,d=this.g,e,f,g,h=0;this.U.ra();this.dc?(this.U.ca=-1,h+=c.m):(g=a.e,e=this.vc.va,a=g.a.x*e.x+g.b.x*e.y,e=g.a.y*e.x+g.b.y*e.y,g=c.e,f=g.a.x*this.j.x+g.b.x*this.j.y,g=g.a.y*this.j.x+g.b.y*this.j.y,f=f*e-g*a,this.U.L.n(-a,-e),this.U.ca=-f,h+=c.h+c.m*f*f);this.ec?(this.U.da=-this.X,h+=this.X*this.X*d.m):(g=b.e,e=this.wc.va,a=g.a.x*e.x+g.b.x*e.y,e=g.a.y*e.x+g.b.y*e.y,g=d.e,f=g.a.x*this.k.x+g.b.x*this.k.y,g=g.a.y*this.k.x+g.b.y*this.k.y,f=f*e-
g*a,this.U.M.n(-this.X*a,-this.X*e),this.U.da=-this.X*f,h+=this.X*this.X*(d.h+d.m*f*f));this.Da=1/h;c.d.x+=c.h*this.I*this.U.L.x;c.d.y+=c.h*this.I*this.U.L.y;c.f+=c.m*this.I*this.U.ca;d.d.x+=d.h*this.I*this.U.M.x;d.d.y+=d.h*this.I*this.U.M.y;d.f+=d.m*this.I*this.U.da};oc.prototype.Cb=function(){var a=this.i,b=this.g,c=-this.Da*ic(this.U,a.d,a.f,b.d,b.f);this.I+=c;a.d.x+=a.h*c*this.U.L.x;a.d.y+=a.h*c*this.U.L.y;a.f+=a.m*c*this.U.ca;b.d.x+=b.h*c*this.U.M.x;b.d.y+=b.h*c*this.U.M.y;b.f+=b.m*c*this.U.da};
oc.prototype.tb=function(){var a=this.i,b=this.g,c=-this.Da*(this.Uc-((this.dc?pc(this.dc):kc(this.vc))+this.X*(this.ec?pc(this.ec):kc(this.wc))));a.c.x+=a.h*c*this.U.L.x;a.c.y+=a.h*c*this.U.L.y;a.l+=a.m*c*this.U.ca;b.c.x+=b.h*c*this.U.M.x;b.c.y+=b.h*c*this.U.M.y;b.l+=b.m*c*this.U.da;a.e.n(a.l);b.e.n(b.l);return m};function qc(a){this.p=new U;this.q=new U;this.jb=a.type;this.s=this.F=s;this.i=a.za;this.g=a.Aa;this.la=a.la;this.zb=t;this.Lb=a.S;this.ya=new T;this.pa=new T;this.qa=new T;this.cb=new T;this.j=new P;this.k=new P;this.Qa=new P;this.Jb=new T;var b,c,d;b=this.i.e;c=a.Pb.x-this.i.c.x;d=a.Pb.y-this.i.c.y;this.j.x=c*b.a.x+d*b.a.y;this.j.y=c*b.b.x+d*b.b.y;b=this.g.e;c=a.Pb.x-this.g.c.x;d=a.Pb.y-this.g.c.y;this.k.x=c*b.a.x+d*b.a.y;this.k.y=c*b.b.x+d*b.b.y;this.Pe=this.g.l-this.i.l;this.Qa.n(0,0);this.ha=
this.v=this.ea=0;this.ie=a.eg;this.pe=a.ug;this.Ve=a.sg;this.le=a.Sf;this.wb=a.qf;this.uc=a.rf}F(qc,V);function pc(a){return a.g.l-a.i.l}new T;E=qc.prototype;E.pa=new T;E.qa=new T;E.cb=new T;
E.Nb=function(){var a=this.i,b=this.g,c;c=a.e;var d=c.a.x*this.j.x+c.b.x*this.j.y,e=c.a.y*this.j.x+c.b.y*this.j.y;c=b.e;var f=c.a.x*this.k.x+c.b.x*this.k.y;c=c.a.y*this.k.x+c.b.y*this.k.y;var g=a.h,h=b.h,j=a.m,k=b.m;this.pa.a.x=g+h;this.pa.b.x=0;this.pa.a.y=0;this.pa.b.y=g+h;this.qa.a.x=j*e*e;this.qa.b.x=-j*d*e;this.qa.a.y=-j*d*e;this.qa.b.y=j*d*d;this.cb.a.x=k*c*c;this.cb.b.x=-k*f*c;this.cb.a.y=-k*f*c;this.cb.b.y=k*f*f;Sa(this.ya,this.pa);Ta(this.ya,this.qa);Ta(this.ya,this.cb);Ua(this.ya,this.Jb);
this.Pa=1/(j+k);this.uc==t&&(this.ea=0);if(this.wb){var l=b.l-a.l-this.Pe;Math.abs(this.pe-this.ie)<2*Ha?this.N=3:l<=this.ie?(1!=this.N&&(this.v=0),this.N=1):l>=this.pe?(2!=this.N&&(this.v=0),this.N=2):this.v=this.N=0}else this.v=0;Sb?(a.d.x-=g*this.Qa.x,a.d.y-=g*this.Qa.y,a.f-=j*(d*this.Qa.y-e*this.Qa.x+this.ea+this.v),b.d.x+=h*this.Qa.x,b.d.y+=h*this.Qa.y,b.f+=k*(f*this.Qa.y-c*this.Qa.x+this.ea+this.v)):(this.Qa.ra(),this.v=this.ea=0);this.ha=0};
E.Cb=function(a){var b=this.i,c=this.g,d;d=b.e;var e=d.a.x*this.j.x+d.b.x*this.j.y,f=d.a.y*this.j.x+d.b.y*this.j.y;d=c.e;var g=d.a.x*this.k.x+d.b.x*this.k.y;d=d.a.y*this.k.x+d.b.y*this.k.y;var h=c.d.x+-c.f*d-b.d.x- -b.f*f,j=c.d.y+c.f*g-b.d.y-b.f*e,k=-(this.Jb.a.x*h+this.Jb.b.x*j),h=-(this.Jb.a.y*h+this.Jb.b.y*j);this.Qa.x+=k;this.Qa.y+=h;b.d.x-=b.h*k;b.d.y-=b.h*h;b.f-=b.m*(e*h-f*k);c.d.x+=c.h*k;c.d.y+=c.h*h;c.f+=c.m*(g*h-d*k);this.uc&&3!=this.N&&(e=-this.Pa*(c.f-b.f-this.le),f=this.ea,this.ea=X(this.ea+
e,-a.Ra*this.Ve,a.Ra*this.Ve),e=this.ea-f,b.f-=b.m*e,c.f+=c.m*e);this.wb&&0!=this.N&&(e=-this.Pa*(c.f-b.f),3==this.N?this.v+=e:1==this.N?(a=this.v,this.v=Math.max(this.v+e,0),e=this.v-a):2==this.N&&(a=this.v,this.v=Math.min(this.v+e,0),e=this.v-a),b.f-=b.m*e,c.f+=c.m*e)};
E.tb=function(){var a,b=this.i,c=this.g,d=0,d=b.e,e=d.a.x*this.j.x+d.b.x*this.j.y,f=d.a.y*this.j.x+d.b.y*this.j.y,d=c.e;a=d.a.x*this.k.x+d.b.x*this.k.y;var g=d.a.y*this.k.x+d.b.y*this.k.y,h=c.c.x+a-(b.c.x+e),j=c.c.y+g-(b.c.y+f),d=Math.sqrt(h*h+j*j),k=b.h,l=c.h,n=b.m,q=c.m;this.pa.a.x=k+l;this.pa.b.x=0;this.pa.a.y=0;this.pa.b.y=k+l;this.qa.a.x=n*f*f;this.qa.b.x=-n*e*f;this.qa.a.y=-n*e*f;this.qa.b.y=n*e*e;this.cb.a.x=q*g*g;this.cb.b.x=-q*a*g;this.cb.a.y=-q*a*g;this.cb.b.y=q*a*a;Sa(this.ya,this.pa);
Ta(this.ya,this.qa);Ta(this.ya,this.cb);this.ya.Kd(rc,-h,-j);h=rc.x;j=rc.y;b.c.x-=b.h*h;b.c.y-=b.h*j;b.l-=b.m*(e*j-f*h);b.e.n(b.l);c.c.x+=c.h*h;c.c.y+=c.h*j;c.l+=c.m*(a*j-g*h);c.e.n(c.l);e=0;this.wb&&0!=this.N&&(a=c.l-b.l-this.Pe,f=0,3==this.N?(a=X(a,-Ia,Ia),f=-this.Pa*a,e=Math.abs(a)):1==this.N?(a-=this.ie,e=Math.max(0,-a),a=X(a+Ha,-Ia,0),f=-this.Pa*a,a=this.ha,this.ha=Math.max(this.ha+f,0),f=this.ha-a):2==this.N&&(a-=this.pe,e=Math.max(0,a),a=X(a-Ha,0,Ia),f=-this.Pa*a,a=this.ha,this.ha=Math.min(this.ha+
f,0),f=this.ha-a),b.l-=b.m*f,b.e.n(b.l),c.l+=c.m*f,c.e.n(c.l));return 0.15>=d&&e<=Ha};var rc=new P;function sc(a){this.p=new U;this.q=new U;this.jb=a.type;this.s=this.F=s;this.i=a.za;this.g=a.Aa;this.la=a.la;this.zb=t;this.Lb=a.S;this.j=new P;this.k=new P;this.fa=new P;var b,c,d;b=this.i.e;c=a.Qb.x-this.i.c.x;d=a.Qb.y-this.i.c.y;this.j.x=c*b.a.x+d*b.a.y;this.j.y=c*b.b.x+d*b.b.y;b=this.g.e;c=a.Rb.x-this.g.c.x;d=a.Rb.y-this.g.c.y;this.k.x=c*b.a.x+d*b.a.y;this.k.y=c*b.b.x+d*b.b.y;c=a.Rb.x-a.Qb.x;d=a.Rb.y-a.Qb.y;this.Qf=Math.sqrt(c*c+d*d);this.I=0}F(sc,V);
sc.prototype.Nb=function(){var a;a=this.i.e;var b=a.a.x*this.j.x+a.b.x*this.j.y,c=a.a.y*this.j.x+a.b.y*this.j.y;a=this.g.e;var d=a.a.x*this.k.x+a.b.x*this.k.y;a=a.a.y*this.k.x+a.b.y*this.k.y;this.fa.x=this.g.c.x+d-this.i.c.x-b;this.fa.y=this.g.c.y+a-this.i.c.y-c;var e=Math.sqrt(this.fa.x*this.fa.x+this.fa.y*this.fa.y);0.15<e?this.fa.scale(1/e):this.fa.ra();var e=b*this.fa.y-c*this.fa.x,f=d*this.fa.y-a*this.fa.x;this.Da=this.i.h+this.i.m*e*e+this.g.h+this.g.m*f*f;this.Da=1/this.Da;Sb?(e=this.I*this.fa.x,
f=this.I*this.fa.y,this.i.d.x-=this.i.h*e,this.i.d.y-=this.i.h*f,this.i.f-=this.i.m*(b*f-c*e),this.g.d.x+=this.g.h*e,this.g.d.y+=this.g.h*f,this.g.f+=this.g.m*(d*f-a*e)):this.I=0};
sc.prototype.Cb=function(){var a;a=this.i.e;var b=a.a.x*this.j.x+a.b.x*this.j.y,c=a.a.y*this.j.x+a.b.y*this.j.y;a=this.g.e;var d=a.a.x*this.k.x+a.b.x*this.k.y;a=a.a.y*this.k.x+a.b.y*this.k.y;var e=-this.Da*(this.fa.x*(this.g.d.x+-this.g.f*a-(this.i.d.x+-this.i.f*c))+this.fa.y*(this.g.d.y+this.g.f*d-(this.i.d.y+this.i.f*b)));this.I+=e;var f=e*this.fa.x,e=e*this.fa.y;this.i.d.x-=this.i.h*f;this.i.d.y-=this.i.h*e;this.i.f-=this.i.m*(b*e-c*f);this.g.d.x+=this.g.h*f;this.g.d.y+=this.g.h*e;this.g.f+=this.g.m*
(d*e-a*f)};
sc.prototype.tb=function(){var a;a=this.i.e;var b=a.a.x*this.j.x+a.b.x*this.j.y,c=a.a.y*this.j.x+a.b.y*this.j.y;a=this.g.e;var d=a.a.x*this.k.x+a.b.x*this.k.y;a=a.a.y*this.k.x+a.b.y*this.k.y;var e=this.g.c.x+d-this.i.c.x-b,f=this.g.c.y+a-this.i.c.y-c,g=Math.sqrt(e*e+f*f),e=e/g,f=f/g,g=g-this.Qf,g=X(g,-6,6),h=-this.Da*g;this.fa.n(e,f);e=h*this.fa.x;f=h*this.fa.y;this.i.c.x-=this.i.h*e;this.i.c.y-=this.i.h*f;this.i.l-=this.i.m*(b*f-c*e);this.g.c.x+=this.g.h*e;this.g.c.y+=this.g.h*f;this.g.l+=this.g.m*
(d*f-a*e);this.i.e.n(this.i.l);this.g.e.n(this.g.l);return 0.15>Math.abs(g)};function ja(a){switch(a.type){case 3:return new sc(a);case 5:return new lc(a);case 2:return new jc(a);case 1:return new qc(a);case 4:return new mc(a);case 6:return new oc(a);default:throw"def not supported";}};function tc(a,b,c){this.Dd=new Vb;this.Yb=new Mb(this);this.Qe=s;this.cg=pb;this.Z=this.W=this.Hb=s;this.pb=this.Xb=this.Na=0;this.ud=s;this.Kf=c;this.Mf=b;this.Yb.xa=this;this.gb=new dc(a,this.Yb);a=new xa;this.Oe=ya(this,a);this.uf=[];this.Vf=t}function ya(a,b){var c=new lb(b,a);c.F=s;if(c.s=a.Hb)a.Hb.F=c;a.Hb=c;++a.Na;return c}
function da(a,b){var c=b.la;b.F&&(b.F.s=b.s);b.s&&(b.s.F=b.F);b==a.Z&&(a.Z=b.s);var d=b.i,e=b.g;ma(d);ma(e);b.p.r&&(b.p.r.next=b.p.next);b.p.next&&(b.p.next.r=b.p.r);b.p==d.Z&&(d.Z=b.p.next);b.p.r=s;b.p.next=s;b.q.r&&(b.q.r.next=b.q.next);b.q.next&&(b.q.next.r=b.q.r);b.q==e.Z&&(e.Z=b.q.next);b.q.r=s;b.q.next=s;--a.pb;if(c==t)for(c=(d.fc<e.fc?d:e).gc;c;c=c.s)c.Jd(a.gb)}
tc.prototype.Hc=function(a,b,c){var d=[],e=this.gb,f=[],g=[];fb(e,f,g,a);a=[0];var h=[0];e.Hc(a,h,f[0],g[0],e.fb[0],2*e.cc,0);e.Hc(a,h,f[1],g[1],e.fb[1],2*e.cc,1);for(g=f=0;g<e.Kb&&f<c;++g,++f)d[g]=e.Ga[e.$c[g]].S;e.Kb=0;ec(e);c=f;for(e=0;e<c;++e)b[e]=d[e];return c};var Tb=1,Sb=1;function uc(){var a=new Za;a.K.n(-2048,-2048);a.O.n(2048,2048);this.Ub=new tc(a,new P(0,300),m)}var vc=s;function fa(){vc||(vc=new uc);return vc}
uc.prototype.Ya=function(a){var b=this.Ub,c,d;b.Dd.Ra=a;b.Dd.Ud=1;b.Dd.Td=0<a?1/a:0;b.We=0;b.Yb.fe=m;for(var e=b.ud;e;){for(var f=e,e=e.s,g=f.Z;g;)c=g,g=g.next,da(b,c.Sb);for(g=f.W;g;)c=g,g=g.next,Nb(b.Yb,c.sa);for(f=f.gc;f;)g=f,f=f.s,65535!=g.Wa&&g.V.xa.gb.Dc(g.Wa)}b.ud=s;b.Yb.fe=t;e=b.Yb;for(f=e.xa.W;f!=s;)g=f,f=f.s,g.o&2&&Nb(e,g);for(var h,e=b.Yb.xa.W;e!=s;e=e.s)if((e.Q.V.o&Y)!=Y||(e.R.V.o&Y)!=Y)f=e.Oa,e.Ec(),g=e.Oa,0==f&&0<g?(f=e.Q.V,g=e.R.V,c=e.p,h=e.q,c.sa=e,c.na=g,c.r=s,c.next=f.W,c.next!=
s&&(c.next.r=e.p),f.W=e.p,h.sa=e,h.na=f,h.r=s,h.next=g.W,h.next!=s&&(h.next.r=h),g.W=h):0<f&&0==g&&(f=e.Q.V,g=e.R.V,c=e.p,h=e.q,c.r&&(c.r.next=c.next),c.next&&(c.next.r=c.r),c==f.W&&(f.W=c.next),c.r=s,c.next=s,h.r&&(h.r.next=h.next),h.next&&(h.next.r=h.r),h==g.W&&(g.W=h.next),h.r=s,h.next=s);e=new Rb(b.Na,b.Xb,b.pb);for(c=b.Hb;c!=s;c=c.s)c.o&=-5;for(f=b.W;f!=s;f=f.s)f.o&=-2;for(f=b.Z;f!=s;f=f.s)f.zb=t;f=Array(b.Na);for(g=0;g<b.Na;g++)f[g]=s;for(g=b.Hb;g!=s;g=g.s)if(!(g.o&(mb|4|Y|ob))){c=e;c.Na=0;
c.Xb=0;h=c.pb=0;f[h++]=g;for(g.o|=4;0<h;)if(d=c=f[--h],e.vb[e.Na++]=d,c.o&=~Y,!(c.o&mb)){for(var j=c.W;j!=s;j=j.next)j.sa.o&1||(d=j.sa,e.ee[e.Xb++]=d,j.sa.o|=1,d=j.na,d.o&4||(f[h++]=d,d.o|=4));for(c=c.Z;c!=s;c=c.next)c.Sb.zb!=m&&(d=c.Sb,e.Wc[e.pb++]=d,c.Sb.zb=m,d=c.na,d.o&4||(f[h++]=d,d.o|=4))}e.Kd(b.Dd,b.Mf);b.We=Math.max(b.We,Ub);if(b.Kf){c=b;h=e;d=a;for(var j=0,k=void 0,l=Number.MAX_VALUE,n=Ka*Ka,j=0;j<h.Na;++j)k=h.vb[j],0!=k.h&&(0==(k.o&nb)&&(l=k.zc=0),0==(k.o&nb)||k.f*k.f>n||0.09<Na(k.d,k.d)?
l=k.zc=0:(k.zc+=d,l=Math.min(l,k.zc)));if(0.5<=l){for(j=0;j<h.Na;++j)k=h.vb[j],k.o|=Y;h=m}else h=t;c.Vf=h}for(h=0;h<e.Na;++h)c=e.vb[h],c.o&mb&&(c.o&=-5),(c.o&ob)==ob&&b.Qe&&1==b.Qe.Zf(c)&&(d=b,c.o&32||(c.F&&(c.F.s=c.s),c.s&&(c.s.F=c.F),c==d.Hb&&(d.Hb=c.s),c.o|=32,--d.Na,c.F=s,c.s=d.ud,d.ud=c),e.vb[h]=s)}b.uf=b.gb.Cc()};function wc(){this.Gf={};this.Nc=this.Mc=-50;this.Zd=this.Yd=0;this.pc=new ca(this.Mc,this.Nc);this.Je=new ca(this.Yd,this.Zd);this.Ie=this.Lc=t};function xc(a,b){this.If=30;this.Jf=require("websocket").server;this.Bf=require("http");this.be=a;this.Gb=[];this.Ee=this.Bf.createServer(v());var c={};c.httpServer=this.Ee;this.Me=new this.Jf(c);this.Me.Fb=this;this.Me.on("request",function(a){console.log("a user log in");a=a.accept(s,a.origin);this.Fb.Gb.length>=this.Fb.If?(console.log("user rejected"),a.send('["REJECTED","Too many players connected."]'),a.close()):(this.Fb.Gb.push(a),a.sc="",a.sd=this,a.ta=new wc,a.hg=yc++,a.De=0,this.Fb.be.oc.bf(a),
a.on("message",function(a){try{var b=JSON.parse(a.utf8Data),c=b[1];switch(b[0]){case "UINPUT":var d=this.ta;d.Yd=d.Mc;d.Zd=d.Nc;d.Je.t=d.Yd;d.Je.u=d.Zd;d.Ie=d.Lc;d.Lc=d.gg;d.Gf=c.keys;d.Mc=c.mx;d.Nc=c.my;d.Lc=c.md;d.pc.t=d.Mc;d.pc.u=d.Nc;break;case "UNAME":this.sc=c,this.sd.Fb.be.oc.af(this)}}catch(j){this.De++,console.log("Exception "+j),4<this.De&&this.close()}}),a.on("close",function(){this.sd.Fb.Gb.splice(this.sd.Fb.Gb.indexOf(this),1);console.log("a user disconnect");this.sd.Fb.be.oc.cf(this)}))});
this.Ee.listen(b,v());console.log("Server comunication initialized")}var yc=1E3;function zc(){Ac(aa)}function Ac(a){var b=(new Date).getTime(),c=b-a.Ge;a.oc.Ya(c/1E3);for(var d=Math.floor(Math.max(1,c/(1E3/30))),e=0;e<d;++e)a.Ef.Ya(c/d/1E3);a.Ge=b;b=1/a.Wd-((new Date).getTime()-b)/1E3;a.ae&&setTimeout(zc,1E3*b)};var Bc=new function(){var a=new Fa,b=L.xe,c=L.we;this.ae=t;this.Wd=c||20;this.Ge=(new Date).getTime();aa=this;this.oc=a||new Aa;this.oc.He=this;this.Ce=new xc(this,b);this.Ke=[];this.Ef=fa()};!Bc.ae&&Bc.oc!=s&&(Bc.ae=m,Ac(Bc));})();
