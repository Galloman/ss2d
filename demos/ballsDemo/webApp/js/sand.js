var e=!0,f=null,g=!1;function j(a,b){function c(){}c.prototype=b.prototype;a.qa=b.prototype;a.prototype=new c};function k(a){this.n=a;a=a.l;a.style.outline="none";this.q=this.n.z=g;if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))this.q=e;this.q||window.addEventListener("mousedown",m,e);window.addEventListener("keydown",n,e);window.addEventListener("keyup",n,e);a.addEventListener("mousedown",n,e);a.addEventListener("mouseup",n,e);a.addEventListener("mousemove",n,e);a.addEventListener("touchstart",n,g);a.addEventListener("touchend",
n,g);a.addEventListener("touchcancel",n,g);a.addEventListener("touchleave",n,g);this.O=[];this.w=this.v=-50;this.S=this.R=0;this.B=g;this.s=new p(this.v,this.w);this.P=new p(this.R,this.S);this.G=this.T=g}k.prototype.r=function(){this.R=this.v;this.S=this.w;this.P.b=this.R;this.P.c=this.S;this.T=this.B;this.B=this.G};function n(a){q.u.handleEvent(a)}function m(){var a=q.u;a.n.z&&(a.n.z=g,a.G=g)}
k.prototype.handleEvent=function(a){var b=e;switch(a.type){case "mousedown":case "touchstart":b=this.q?window.event.targetTouches[0]:a;this.v=b.offsetX||b.pageX-this.n.l.offsetLeft;this.w=b.offsetY||b.pageY-this.n.l.offsetTop;this.s.b=this.v;this.s.c=this.w;if(this.q&&b||!this.q)this.G=this.n.z=e,a.preventDefault(),a.stopPropagation(),this.n.l.addEventListener("touchmove",n,g);b=g;break;case "mouseup":case "touchend":case "touchcancel":b=this.q?window.event.targetTouches[0]:a;if(this.q&&!b||!this.q)this.G=
this.B=g,a.preventDefault(),a.stopPropagation(),this.n.l.removeEventListener("touchmove",n,g);b=g;break;case "keydown":this.n.z?(this.O[parseInt(a.keyCode)]=e,(37==a.keyCode||38==a.keyCode||39==a.keyCode||40==a.keyCode||32==a.keyCode)&&a.preventDefault(),b=g):b=e;break;case "keyup":b=this.n.z?this.O[parseInt(a.keyCode)]=g:e;break;case "mousemove":case "touchmove":if(a=this.q?window.event.targetTouches[0]:a)this.v=a.offsetX||a.pageX-this.n.l.offsetLeft,this.w=a.offsetY||a.pageY-this.n.l.offsetTop,
this.s.b=this.v,this.s.c=this.w;b=void 0}return b};function p(a,b){this.b=a;this.c=b}p.prototype.length=function(){return Math.sqrt(this.b*this.b+this.c*this.c)};function r(a,b){return Math.abs(Math.sqrt((b.b-a.b)*(b.b-a.b)+(b.c-a.c)*(b.c-a.c)))}function s(a,b){return new p(b.b-a.b,b.c-a.c)};function t(){this.d=1;this.f=this.e=0;this.i=1;this.k=this.j=0;this.na=Array(9)}function u(a,b,c,d,h,l,M){a.d=b;a.e=c;a.f=d;a.i=h;a.j=l;a.k=M}t.prototype.toString=function(){return"(a="+this.d+", b="+this.e+", c="+this.f+", d="+this.i+", tx="+this.j+", ty="+this.k+")"};function v(a,b){u(a,b.d*a.d+b.f*a.e,b.e*a.d+b.i*a.e,b.d*a.f+b.f*a.i,b.e*a.f+b.i*a.i,b.d*a.j+b.f*a.k+1*b.j,b.e*a.j+b.i*a.k+1*b.k)}t.prototype.translate=function(a,b){this.j+=a;this.k+=b;return this};
t.prototype.scale=function(a,b){this.d*=a;this.e*=b;this.f*=a;this.i*=b;this.j*=a;this.k*=b;return this};t.prototype.rotate=function(a){var b=new t;u(b,-Math.cos(a),-Math.sin(a),-Math.sin(a),Math.cos(a),0,0);v(this,b);delete b;return this};function w(a){this.h=a;this.V=new t;this.oa=[];this.ma=new t}function x(a,b){u(a.V,1,0,0,1,0,0);var c=y(b,a.V);a.h.save();a.h.transform(c.d,c.e,c.f,c.i,c.j,c.k)};function z(a){this.l=document.getElementById("mainScene");this.h=this.l.getContext("2d");this.U=g;this.ga=60;this.u=new k(this);this.X=(new Date).getTime();q=this;A=B();this.L=a||f;this.ia=new w(this.h);this.W="#202020"}var q=f;function C(){D(q)}var A=f;function B(){if(A)return A;if("undefined"!==typeof AudioContext)return new AudioContext;if("undefined"!==typeof webkitAudioContext)return new webkitAudioContext;console.log("AudioContext not supported");return f}
function D(a){var b=(new Date).getTime(),c=b-a.X;a.L.r(c/1E3);a.u.r(c/1E3);a.h.fillStyle=a.W;a.h.fillRect(0,0,a.l.width,a.l.height);a.L.A(a.ia);a.X=b;b=1/a.ga-((new Date).getTime()-b)/1E3;a.U&&setTimeout(C,1E3*b)};function E(a){if(a instanceof Array&&2<a.length)this.H=a;else if("string"==typeof a||"number"==typeof a)"string"==typeof a&&(a=parseInt("0x"+a.replace("#","").substring(0,6))),a&=16777215,this.H=[(a&16711680)>>16,(a&65280)>>8,a&255]}function F(a){var b=Math.floor(a.H[0]).toString(16),b=1==b.length?"0"+b:b,c=Math.floor(a.H[1]).toString(16),c=1==c.length?"0"+c:c;a=Math.floor(a.H[2]).toString(16);a=1==a.length?"0"+a:a;return"#"+b+c+a};function G(a,b,c,d,h,l){this.a=new p(a||0,b||0);this.$=d||0;this.N=this.M=0;this.aa=c||1;this.ba=c||1;this.t=f;this.I=g;this.Z=this.Y=0;this.K=h instanceof E?h:new E(h||16777215);this.la=l||1}function y(a,b){b=b||new t;(0!=a.M||0!=a.N)&&b.translate(-a.M,-a.N);(0!=a.Y||0!=a.Z)&&b.translate(-a.Y,-a.Z);(1!=a.aa||1!=a.ba)&&b.scale(a.aa,a.ba);0!=a.$&&b.rotate(a.$);(0!=a.a.b||0!=a.a.c)&&b.translate(a.a.b,a.a.c);return b}G.prototype.r=f;G.prototype.A=f;G.prototype.F=function(){return f};function H(a,b,c,d,h){G.call(this,a,b,1,0,h,1);this.ka=c||10;this.ha=d||10}j(H,G);H.prototype.A=function(a){x(a,this);var b=a.h;b.fillStyle=F(this.K);b.rect(0,0,this.ka,this.ha);a.h.restore()};function I(){var a=J,b=K;a&&(this.pa=a,this.J=new Image,this.J.ja=this,this.J.fa=b,this.J.onload=b?function(){this.fa.call(f,this.ja)}:function(){},this.J.src=a,L++)}var L=0;var N={};function O(a,b,c,d){H.call(this,a,b,2*c,2*c,d);this.m=c;this.I=g;this.M=this.N=c}j(O,H);O.prototype.A=function(a){x(a,this);var b=a.h;b.beginPath();b.fillStyle=F(this.K);b.arc(this.m,this.m,this.m,0,2*Math.PI,e);b.closePath();b.fill();a.h.restore()};
O.prototype.F=function(a){for(var b=new p(this.a.b,this.a.c),c=[],d=this;d.t;)c.unshift(d.t),d=d.t;var d=new t,h=new t;for(matIndex in c)u(h,1,0,0,1,0,0),y(c[matIndex],h),v(d,h);c=d.d*d.i-d.f*d.e;u(d,d.i/c,-d.e/c,-d.f/c,d.d/c,(d.f*d.k-d.i*d.j)/c,(d.e*d.j-d.d*d.k)/c);var l;l||(l=new p(0,0));c=a.b;l.b=d.d*a.b+d.f*a.c+d.j;l.c=d.e*c+d.i*a.c+d.k;a=l;delete worldMatrix;a=r(b,a);delete b;return a<=this.m?this:f};O.prototype.r=f;
O.prototype.r=function(a){if(!this.I){var b=s(this.a,P.p.u.s),c=r(this.a,P.p.u.s),d=P.p.u.O[16]?1:-1;this.a.b+=0.3*(Math.max(0,100-c)*b.b*a)*d;this.a.c+=0.3*(Math.max(0,100-c)*b.c*a)*d;this.a.b=Math.max(Math.min(this.a.b,Q.D-this.m),this.m);this.a.c=Math.max(Math.min(this.a.c,Q.C-this.m),this.m);for(var h in this.t.g)b=this.t.g[h],b instanceof O&&(c=s(this.a,b.a),d=c.length(),this.a.b+=-Math.max(0,b.m+this.m-d)*c.b*a,this.a.c+=-Math.max(0,b.m+this.m-d)*c.c*a)}};var Q={ca:60,D:800,C:600,da:"localhost",ea:0,ca:60,D:800,C:600,da:"localhost",ea:51337};function R(a,b,c,d){G.call(this,a,b,c,d);this.g=[]}j(R,G);R.prototype.A=function(a){x(a,this);for(var b in this.g)this.g[b].A(a);a.h.restore()};function S(a,b){if(b instanceof Array)for(var c in b)S(a,b[c]);else if(b instanceof G){if(b.t)if(c=b.t,b instanceof Array)for(var d in b)c.g.splice(c.g.indexOf(b[d]),1);else c.g.splice(c.g.indexOf(b),1);b.t=a;a.g.push(b)}}R.prototype.F=function(a){var b=f,c;for(c in this.g)b=this.g[c].F(a)||b;return b};function T(){R.call(this);this.p=new z(this);this.p.W="#000000";this.p.l.width=Q.D;this.p.l.height=Q.C;for(var a=100;a--;){var b=new O(0.5*Q.D+10*Math.random(),0.5*Q.C+10*Math.random(),10,"#"+Math.floor(16777215*Math.max(Math.random(),0.2)).toString(16));S(this,b)}this.o=f;a=new G;a.r=function(){this.a.b=5;this.a.c=window.innerHeight-10};a.A=function(a){a.h.font="normal 14px Verdana";a.h.fillStyle="#FFFFFF";a.h.fillText("Press shift to invert cursor force",this.a.b,this.a.c)};S(this,a);this.p.z=e}
j(T,R);T.prototype.r=function(a){var b=this.p.u;this.o&&(this.o.I=g);b.B&&!b.T&&((this.o=this.F(b.s))||S(this,new O(b.v-3*Math.random()+3*Math.random(),b.w-3*Math.random()+3*Math.random(),Math.max(15*Math.random(),10),"#"+Math.floor(16777215*Math.max(Math.random(),0.2)).toString(16))));b.B&&(b.T&&this.o)&&(b=s(b.P,b.s),this.o.a.b+=b.b,this.o.a.c+=b.c,this.o.I=e);for(var c in this.g)this.g[c].r&&this.g[c].r(a)};var P=f,J=["images/SwitchBall64.png"];
function K(){P=new T;var a=P.p;!a.U&&a.L!=f&&(a.U=e,D(a))}N[J+".texture"]||(N[J+".texture"]=new I);
